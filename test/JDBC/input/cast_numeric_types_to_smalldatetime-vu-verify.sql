USE master
GO

SELECT CAST(0 as SMALLDATETIME)
GO

SELECT CAST(10 as SMALLDATETIME)
GO

SELECT CAST(3.1215926 as SMALLDATETIME)
GO

SELECT CAST(216.5937465072345996348935531215926 as SMALLDATETIME)
GO

SELECT CAST(-46.781289 as SMALLDATETIME)
GO

SELECT CAST(999999999 as SMALLDATETIME)
GO

SELECT CAST(-999999999 as SMALLDATETIME)
GO

--=== Test casting BIT to SMALLDATETIME ===--
SELECT CAST(CAST (0 as BIT) as SMALLDATETIME)
GO

SELECT CAST(CAST (1 as BIT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-1 as BIT) as SMALLDATETIME)
GO

SELECT CAST(CAST (5 as BIT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-5 as BIT) as SMALLDATETIME)
GO

--=== Test casting NUMERIC to SMALLDATETIME ===--
SELECT CAST(CAST (0 as NUMERIC) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as NUMERIC) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as NUMERIC) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as NUMERIC(19,7)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as NUMERIC(6,2)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as NUMERIC(32,17)) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as NUMERIC(1,2)) as SMALLDATETIME)
GO

--=== Test casting DECIMAL to SMALLDATETIME ===--
SELECT CAST(CAST (0 as DECIMAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as DECIMAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as DECIMAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as DECIMAL(19,7)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as DECIMAL(6,2)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as DECIMAL(32,17)) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as DECIMAL(1,2)) as SMALLDATETIME)
GO

--=== Test casting FLOAT to SMALLDATETIME ===--
SELECT CAST(CAST (0 as FLOAT) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as FLOAT) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as FLOAT) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as FLOAT(12)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as FLOAT(50)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as FLOAT(1)) as SMALLDATETIME)
GO

SELECT CAST(CAST (999999999 as FLOAT(53)) as SMALLDATETIME)
GO

SELECT CAST(CAST (-999999999 as FLOAT(53)) as SMALLDATETIME)
GO

--=== Test casting REAL to SMALLDATETIME ===--
SELECT CAST(CAST (0 as REAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as REAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as REAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as REAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as REAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (999999999 as REAL) as SMALLDATETIME)
GO

SELECT CAST(CAST (-999999999 as REAL) as SMALLDATETIME)
GO

--=== Test casting INT to SMALLDATETIME ===--
SELECT CAST(CAST (0 as INT) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as INT) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as INT) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as INT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as INT) as SMALLDATETIME)
GO

--=== Test casting BIGINT to SMALLDATETIME ===--
SELECT CAST(CAST (0 as BIGINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as BIGINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as BIGINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as BIGINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as BIGINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (999999999 as BIGINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-999999999 as BIGINT) as SMALLDATETIME)
GO

--=== Test casting SMALLINT to SMALLDATETIME ===--
SELECT CAST(CAST (0 as SMALLINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as SMALLINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as SMALLINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as SMALLINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as SMALLINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (999999999 as SMALLINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-999999999 as SMALLINT) as SMALLDATETIME)
GO

--=== Test casting TINYINT to SMALLDATETIME ===--
SELECT CAST(CAST (0 as TINYINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as TINYINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as TINYINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (260.5937465072345996348935531215926 as TINYINT) as SMALLDATETIME)
GO

SELECT CAST(CAST (-1 as TINYINT) as SMALLDATETIME)
GO

--=== Test casting MONEY to SMALLDATETIME ===--
SELECT CAST(CAST (0 as MONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as MONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as MONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as MONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as MONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (46.99999999 as MONEY) as SMALLDATETIME)
GO


SELECT CAST(CAST (999999999 as MONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (-999999999 as MONEY) as SMALLDATETIME)
GO

--=== Test casting SMALLMONEY to SMALLDATETIME ===--
SELECT CAST(CAST (0 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (10 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (3.1215926 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (216.5937465072345996348935531215926 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (-46.781289 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (46.99999999 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (215000 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (-215000 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (999999999 as SMALLMONEY) as SMALLDATETIME)
GO

SELECT CAST(CAST (-999999999 as SMALLMONEY) as SMALLDATETIME)
GO

--=== Version upgrade tests ===--
SELECT * FROM smalldatetime_vu_prepare_table
GO

EXEC smalldatetime_vu_prepare_procedure
GO

SELECT dbo.smalldatetime_vu_prepare_function (CAST(345.3 AS SMALLMONEY))
GO
