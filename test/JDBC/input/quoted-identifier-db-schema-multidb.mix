-- psql
ALTER SYSTEM SET babelfishpg_tsql.migration_mode = 'multi-db';
SELECT pg_reload_conf();
GO

-- check if correct schema is present in search path
-- tsql
CREATE DATABASE ["BABEL_5111.db"]
GO

use ["BABEL_5111.db"]
GO

CREATE TABLE t1(a int)
GO

SELECT current_setting('search_path')
GO

CREATE SCHEMA ["BABEL_5111.scm"]
GO

CREATE TABLE ["BABEL_5111.scm"].t1(a int)
GO

CREATE VIEW ["BABEL_5111.scm"].v1 AS SELECT 1
GO

CREATE TRIGGER ["BABEL_5111.scm"].BABEL_5111_trgger1 on ["BABEL_5111.scm"].t1 AFTER INSERT AS BEGIN END
GO

ALTER TABLE ["BABEL_5111.scm"].t1 ENABLE TRIGGER BABEL_5111_trgger1
GO

USE master
GO

SELECT * from ["BABEL_5111.db"].["BABEL_5111.scm"].t1
GO

SELECT * from ["BABEL_5111.db"].["BABEL_5111.scm"].v1
GO

use ["BABEL_5111.db"]
GO

DROP TRIGGER ["BABEL_5111.scm"].BABEL_5111_trgger1
GO

DROP VIEW ["BABEL_5111.scm"].v1
GO

DROP TABLE ["BABEL_5111.scm"].t1
GO

DROP SCHEMA ["BABEL_5111.scm"]
GO

DROP TABLE t1
GO

USE master
GO

DROP DATABASE ["BABEL_5111.db"]
GO

-- psql
ALTER SYSTEM SET babelfishpg_tsql.migration_mode = 'single-db';
SELECT pg_reload_conf();
GO