-- psql
analyse master_dbo.test_int8_numeric_vu;
GO

-- tsql
select set_config('max_parallel_workers_per_gather', '0', false);
GO
SELECT set_config('debug_parallel_query', '0', false);
GO
SELECT set_config('babelfishpg_tsql.explain_costs', 'off', false)
GO

SET BABELFISH_SHOWPLAN_ALL on
GO

exec test_int8_numeric_p0;
GO
exec test_int8_numeric_p0;
GO
exec test_int8_numeric_p1;
GO
exec test_int8_numeric_p2;
GO
exec test_int8_numeric_p3;
GO
exec test_int8_numeric_p4;
GO
exec test_int8_numeric_p5;
GO
exec test_int8_numeric_p6;
GO
exec test_int8_numeric_p7;
GO
exec test_int8_numeric_p8;
GO
exec test_int8_numeric_p9;
GO
exec test_int8_numeric_p10;
GO
exec test_int8_numeric_p11;
GO
exec test_int8_numeric_p12;
GO
exec test_int8_numeric_p13;
GO
exec test_int8_numeric_p14;
GO
exec test_int8_numeric_p15;
GO
exec test_int8_numeric_p16;
GO
exec test_int8_numeric_p17;
GO
exec test_int8_numeric_p18;
GO
exec test_int8_numeric_p19;
GO
exec test_int8_numeric_p20;
GO
exec test_int8_numeric_p21;
GO
exec test_int8_numeric_p22;
GO
exec test_int8_numeric_p23;
GO
exec test_int8_numeric_p24;
GO
exec test_int8_numeric_p25;
GO
exec test_int8_numeric_p26;
GO
exec test_int8_numeric_p27;
GO
exec test_int8_numeric_p28;
GO
exec test_int8_numeric_p29;
GO
exec test_int8_numeric_p30;
GO
exec test_int8_numeric_p31;
GO
exec test_int8_numeric_p32;
GO

SET BABELFISH_SHOWPLAN_ALL off
GO

exec test_int8_numeric_p0;
GO
exec test_int8_numeric_p0;
GO
exec test_int8_numeric_p1;
GO
exec test_int8_numeric_p2;
GO
exec test_int8_numeric_p3;
GO
exec test_int8_numeric_p4;
GO
exec test_int8_numeric_p5;
GO
exec test_int8_numeric_p6;
GO
exec test_int8_numeric_p7;
GO
exec test_int8_numeric_p8;
GO
exec test_int8_numeric_p9;
GO
exec test_int8_numeric_p10;
GO
exec test_int8_numeric_p11;
GO
exec test_int8_numeric_p12;
GO
exec test_int8_numeric_p13;
GO
exec test_int8_numeric_p14;
GO
exec test_int8_numeric_p15;
GO
exec test_int8_numeric_p16;
GO
exec test_int8_numeric_p17;
GO
exec test_int8_numeric_p18;
GO
exec test_int8_numeric_p19;
GO
exec test_int8_numeric_p20;
GO
exec test_int8_numeric_p21;
GO
exec test_int8_numeric_p22;
GO
exec test_int8_numeric_p23;
GO
exec test_int8_numeric_p24;
GO
exec test_int8_numeric_p25;
GO
exec test_int8_numeric_p26;
GO
exec test_int8_numeric_p27;
GO
exec test_int8_numeric_p28;
GO
exec test_int8_numeric_p29;
GO
exec test_int8_numeric_p30;
GO
exec test_int8_numeric_p31;
GO
exec test_int8_numeric_p32;
GO

drop procedure test_int8_numeric_p0;
drop procedure test_int8_numeric_p00;
drop procedure test_int8_numeric_p1;
drop procedure test_int8_numeric_p2;
drop procedure test_int8_numeric_p3;
drop procedure test_int8_numeric_p4;
drop procedure test_int8_numeric_p5;
drop procedure test_int8_numeric_p6;
drop procedure test_int8_numeric_p7;
drop procedure test_int8_numeric_p8;
drop procedure test_int8_numeric_p9;
drop procedure test_int8_numeric_p10;
drop procedure test_int8_numeric_p11;
drop procedure test_int8_numeric_p12;
drop procedure test_int8_numeric_p13;
drop procedure test_int8_numeric_p14;
drop procedure test_int8_numeric_p15;
drop procedure test_int8_numeric_p16;
drop procedure test_int8_numeric_p17;
drop procedure test_int8_numeric_p18;
drop procedure test_int8_numeric_p19;
drop procedure test_int8_numeric_p20;
drop procedure test_int8_numeric_p21;
drop procedure test_int8_numeric_p22;
drop procedure test_int8_numeric_p23;
drop procedure test_int8_numeric_p24;
drop procedure test_int8_numeric_p25;
drop procedure test_int8_numeric_p26;
drop procedure test_int8_numeric_p27;
drop procedure test_int8_numeric_p28;
drop procedure test_int8_numeric_p29;
drop procedure test_int8_numeric_p30;
drop procedure test_int8_numeric_p31;
drop procedure test_int8_numeric_p32;
GO

-- tsql
select set_config('max_parallel_workers_per_gather', '0', false);
GO
SELECT set_config('debug_parallel_query', '0', false);
GO
SELECT set_config('babelfishpg_tsql.explain_costs', 'off', false)
GO

SET BABELFISH_SHOWPLAN_ALL on
GO

select * from test_int8_numeric_v0;
GO
select * from test_int8_numeric_v00;
GO
select * from test_int8_numeric_v1;
GO
select * from test_int8_numeric_v2;
GO
select * from test_int8_numeric_v3;
GO
select * from test_int8_numeric_v4;
GO
select * from test_int8_numeric_v5;
GO
select * from test_int8_numeric_v6;
GO
select * from test_int8_numeric_v7;
GO
select * from test_int8_numeric_v8;
GO
select * from test_int8_numeric_v9;
GO
select * from test_int8_numeric_v10;
GO
select * from test_int8_numeric_v11;
GO
select * from test_int8_numeric_v12;
GO
select * from test_int8_numeric_v13;
GO
select * from test_int8_numeric_v14;
GO
select * from test_int8_numeric_v15;
GO
select * from test_int8_numeric_v16;
GO
select * from test_int8_numeric_v17;
GO
select * from test_int8_numeric_v18;
GO
select * from test_int8_numeric_v19;
GO
select * from test_int8_numeric_v20;
GO
select * from test_int8_numeric_v21;
GO
select * from test_int8_numeric_v22;
GO
select * from test_int8_numeric_v23;
GO
select * from test_int8_numeric_v24;
GO
select * from test_int8_numeric_v25;
GO
select * from test_int8_numeric_v26;
GO
select * from test_int8_numeric_v27;
GO
select * from test_int8_numeric_v28;
GO
select * from test_int8_numeric_v29;
GO
select * from test_int8_numeric_v30;
GO
select * from test_int8_numeric_v31;
GO
select * from test_int8_numeric_v32;
GO

SET BABELFISH_SHOWPLAN_ALL off
GO

select * from test_int8_numeric_v0;
GO
select * from test_int8_numeric_v00;
GO
select * from test_int8_numeric_v1;
GO
select * from test_int8_numeric_v2;
GO
select * from test_int8_numeric_v3;
GO
select * from test_int8_numeric_v4;
GO
select * from test_int8_numeric_v5;
GO
select * from test_int8_numeric_v6;
GO
select * from test_int8_numeric_v7;
GO
select * from test_int8_numeric_v8;
GO
select * from test_int8_numeric_v9;
GO
select * from test_int8_numeric_v10;
GO
select * from test_int8_numeric_v11;
GO
select * from test_int8_numeric_v12;
GO
select * from test_int8_numeric_v13;
GO
select * from test_int8_numeric_v14;
GO
select * from test_int8_numeric_v15;
GO
select * from test_int8_numeric_v16;
GO
select * from test_int8_numeric_v17;
GO
select * from test_int8_numeric_v18;
GO
select * from test_int8_numeric_v19;
GO
select * from test_int8_numeric_v20;
GO
select * from test_int8_numeric_v21;
GO
select * from test_int8_numeric_v22;
GO
select * from test_int8_numeric_v23;
GO
select * from test_int8_numeric_v24;
GO
select * from test_int8_numeric_v25;
GO
select * from test_int8_numeric_v26;
GO
select * from test_int8_numeric_v27;
GO
select * from test_int8_numeric_v28;
GO
select * from test_int8_numeric_v29;
GO
select * from test_int8_numeric_v30;
GO
select * from test_int8_numeric_v31;
GO
select * from test_int8_numeric_v32;
GO

drop view test_int8_numeric_v0;
drop view test_int8_numeric_v00;
drop view test_int8_numeric_v1;
drop view test_int8_numeric_v2;
drop view test_int8_numeric_v3;
drop view test_int8_numeric_v4;
drop view test_int8_numeric_v5;
drop view test_int8_numeric_v6;
drop view test_int8_numeric_v7;
drop view test_int8_numeric_v8;
drop view test_int8_numeric_v9;
drop view test_int8_numeric_v10;
drop view test_int8_numeric_v11;
drop view test_int8_numeric_v12;
drop view test_int8_numeric_v13;
drop view test_int8_numeric_v14;
drop view test_int8_numeric_v15;
drop view test_int8_numeric_v16;
drop view test_int8_numeric_v17;
drop view test_int8_numeric_v18;
drop view test_int8_numeric_v19;
drop view test_int8_numeric_v20;
drop view test_int8_numeric_v21;
drop view test_int8_numeric_v22;
drop view test_int8_numeric_v23;
drop view test_int8_numeric_v24;
drop view test_int8_numeric_v25;
drop view test_int8_numeric_v26;
drop view test_int8_numeric_v27;
drop view test_int8_numeric_v28;
drop view test_int8_numeric_v29;
drop view test_int8_numeric_v30;
drop view test_int8_numeric_v31;
drop view test_int8_numeric_v32;
GO

-- tsql
select set_config('max_parallel_workers_per_gather', '0', false);
GO
SELECT set_config('debug_parallel_query', '0', false);
GO
SELECT set_config('babelfishpg_tsql.explain_costs', 'off', false)
GO

SET BABELFISH_SHOWPLAN_ALL off
GO

select test_int8_numeric_f0();
GO
select test_int8_numeric_f00();
GO
select test_int8_numeric_f1();
GO
select test_int8_numeric_f2();
GO
select test_int8_numeric_f3();
GO
select test_int8_numeric_f4();
GO
select test_int8_numeric_f5();
GO
select test_int8_numeric_f6();
GO
select test_int8_numeric_f7();
GO
select test_int8_numeric_f8();
GO
select test_int8_numeric_f9();
GO
select test_int8_numeric_f10();
GO
select test_int8_numeric_f11();
GO
select test_int8_numeric_f12();
GO
select test_int8_numeric_f13();
GO
select test_int8_numeric_f14();
GO
select test_int8_numeric_f15();
GO
select test_int8_numeric_f16();
GO
select test_int8_numeric_f17();
GO
select test_int8_numeric_f18();
GO
select test_int8_numeric_f19();
GO
select test_int8_numeric_f20();
GO
select test_int8_numeric_f21();
GO
select test_int8_numeric_f22();
GO
select test_int8_numeric_f23();
GO
select test_int8_numeric_f24();
GO
select test_int8_numeric_f25();
GO
select test_int8_numeric_f26();
GO
select test_int8_numeric_f27();
GO
select test_int8_numeric_f28();
GO
select test_int8_numeric_f29();
GO
select test_int8_numeric_f30();
GO
select test_int8_numeric_f31();
GO
select test_int8_numeric_f32();
GO

drop function test_int8_numeric_f0();
drop function test_int8_numeric_f00();
drop function test_int8_numeric_f1();
drop function test_int8_numeric_f2();
drop function test_int8_numeric_f3();
drop function test_int8_numeric_f4();
drop function test_int8_numeric_f5();
drop function test_int8_numeric_f6();
drop function test_int8_numeric_f7();
drop function test_int8_numeric_f8();
drop function test_int8_numeric_f9();
drop function test_int8_numeric_f10();
drop function test_int8_numeric_f11();
drop function test_int8_numeric_f12();
drop function test_int8_numeric_f13();
drop function test_int8_numeric_f14();
drop function test_int8_numeric_f15();
drop function test_int8_numeric_f16();
drop function test_int8_numeric_f17();
drop function test_int8_numeric_f18();
drop function test_int8_numeric_f19();
drop function test_int8_numeric_f20();
drop function test_int8_numeric_f21();
drop function test_int8_numeric_f22();
drop function test_int8_numeric_f23();
drop function test_int8_numeric_f24();
drop function test_int8_numeric_f25();
drop function test_int8_numeric_f26();
drop function test_int8_numeric_f27();
drop function test_int8_numeric_f28();
drop function test_int8_numeric_f29();
drop function test_int8_numeric_f30();
drop function test_int8_numeric_f31();
drop function test_int8_numeric_f32();
GO

-- check constraint testing

insert into test_int8_numeric_t1 values (5, 4, 5, 6, 5, 5.0);
GO

insert into test_int8_numeric_t1 values (4, 4, 5, 6, 5, 5.0);
GO

insert into test_int8_numeric_t1 values (5, 6, 5, 6, 5, 5.0);
GO

insert into test_int8_numeric_t1 values (5, 4, 7, 6, 5, 5.0);
GO

insert into test_int8_numeric_t1 values (5, 4, 5, 4, 5, 5.0);
GO

insert into test_int8_numeric_t1 values (5, 4, 5, 6, 4, 5.0);
GO

SELECT conname, pg_get_constraintdef(c.oid) 
FROM   pg_constraint c JOIN   pg_namespace n ON n.oid = c.connamespace WHERE  contype = 'c' AND conrelid = sys.object_id('dbo.test_int8_numeric_t1')
ORDER  BY conname;
GO

insert into test_int8_numeric_t2 values (5.0, 4.0, 5.0, 6.0, 5.0, 5);
GO

insert into test_int8_numeric_t2 values (4.0, 4.0, 5.0, 6.0, 5.0, 5);
GO

insert into test_int8_numeric_t2 values (5.0, 6.0, 5.0, 6.0, 5.0, 5);
GO

insert into test_int8_numeric_t2 values (5.0, 4.0, 7.0, 6.0, 5.0, 5);
GO

insert into test_int8_numeric_t2 values (5.0, 4.0, 5.0, 4.0, 5.0, 5);
GO

insert into test_int8_numeric_t2 values (5.0, 4.0, 5.0, 6.0, 4.0, 5);
GO

SELECT conname, pg_get_constraintdef(c.oid) 
FROM   pg_constraint c JOIN   pg_namespace n ON n.oid = c.connamespace WHERE  contype = 'c' AND conrelid = sys.object_id('dbo.test_int8_numeric_t2')
ORDER  BY conname;
GO

drop table test_int8_numeric_t1;
GO

drop table test_int8_numeric_t2;
GO

drop table test_int8_numeric_vu;
GO