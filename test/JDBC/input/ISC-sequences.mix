-- tsql
create database isc_sequences_dbone;
go

create sequence isc_sequences_master_seq1 start with 1 minvalue 1 maxvalue 5 cycle;
go

Use isc_sequences_dbone;
go

create schema isc_sequences_sc1;
go

create schema isc_sequences_sc2;
go

create sequence isc_sequences_sc1.isc_sequences_seq1 start with 1 minvalue 1 maxvalue 5 cycle;
go

create sequence isc_sequences_sc1.isc_sequences_seq2 as tinyint start with 2 minvalue 1 maxvalue 5 cycle;
go

create sequence isc_sequences_sc1.isc_sequences_seq3 as smallint start with 3 increment by 3 minvalue 3 maxvalue 10;
go

create sequence isc_sequences_sc1.isc_sequences_seq4 as int start with 4 increment by 2 minvalue 2 maxvalue 10;
go

create sequence isc_sequences_sc2.isc_sequences_seq1 as bigint start with 1 minvalue 1 maxvalue 5 cycle;
go

create sequence isc_sequences_sc2.isc_sequences_seq2 as decimal start with 2 increment by 2 minvalue 2 maxvalue 10;
go

create sequence isc_sequences_sc2.isc_sequences_seq3 as numeric start with 3 increment by 3 minvalue 3 maxvalue 12 cycle;
go

select * from information_schema.SEQUENCES;
go

use master;
go

select * from information_schema.SEQUENCES;
go

use isc_sequences_dbone;
go

--privilege testing
create login isc_sequences_log1 with password='123456789';
go

create user isc_sequences_usr1 for login isc_sequences_log1;
go

-- tsql user=isc_sequences_log1 password=123456789

use isc_sequences_dbone;
go

select * from information_schema.SEQUENCES;
go

-- tsql

use isc_sequences_dbone; 
go

grant select on isc_sequences_sc1.isc_sequences_seq1 to isc_sequences_usr1;
go

-- tsql user=isc_sequences_log1 password=123456789

use isc_sequences_dbone; 
go

select * from information_schema.SEQUENCES;
go

-- tsql

use isc_sequences_dbone; 
go

drop sequence isc_sequences_sc1.isc_sequences_seq1;
go

drop sequence isc_sequences_sc1.isc_sequences_seq2;
go

drop sequence isc_sequences_sc1.isc_sequences_seq3;
go

drop sequence isc_sequences_sc1.isc_sequences_seq4;
go

drop sequence isc_sequences_sc2.isc_sequences_seq1;
go

drop sequence isc_sequences_sc2.isc_sequences_seq2;
go

drop sequence isc_sequences_sc2.isc_sequences_seq3;
go

drop schema isc_sequences_sc1;
go

drop schema isc_sequences_sc2;
go

-- psql
-- Need to terminate active session before cleaning up the login
SELECT pg_terminate_backend(pid) FROM pg_stat_get_activity(NULL) 
WHERE sys.suser_name(usesysid) = 'isc_sequences_log1' AND backend_type = 'client backend' AND usesysid IS NOT NULL;
GO
-- Wait to sync with another session
SELECT pg_sleep(1);
GO

-- tsql 
use isc_sequences_dbone;
go

drop user isc_sequences_usr1; 
go

drop login isc_sequences_log1;
go

use master;
go

drop sequence isc_sequences_master_seq1;
go

drop database isc_sequences_dbone;
go
