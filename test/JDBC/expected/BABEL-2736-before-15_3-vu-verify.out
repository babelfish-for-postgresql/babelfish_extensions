-- Test view v1 (style 0)
SELECT * FROM BABEL_BINARY_vu_prepare_v1
GO
~~START~~
binary
30393034443030303334
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v1
GO

-- Test procedure p1 (style 0)
EXEC BABEL_BINARY_vu_prepare_p1
GO
~~START~~
binary
30393034443030303334
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p1
GO

-- Test function f1 (style 0)
SELECT dbo.BABEL_BINARY_vu_prepare_f1()
GO
~~START~~
varbinary
30393034443030303334
~~END~~

DROP FUNCTION BABEL_BINARY_vu_prepare_f1
GO

-- Test view v2 (style 1)
SELECT * FROM BABEL_BINARY_vu_prepare_v2
GO
~~START~~
binary
30783039303444303030
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v2
GO

-- Test procedure p2 (style 1)
EXEC BABEL_BINARY_vu_prepare_p2
GO
~~START~~
binary
0904D000340000000000
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p2
GO

-- Test function f2 (style 1)
SELECT dbo.BABEL_BINARY_vu_prepare_f2()
GO
~~START~~
varbinary
0904D000340000000000
~~END~~

DROP FUNCTION BABEL_BINARY_vu_prepare_f2
GO

-- Test view v3 (style 2)
SELECT * FROM BABEL_BINARY_vu_prepare_v3
GO
~~START~~
binary
30393034443030303334
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v3
GO

-- Test procedure p3 (style 2)
EXEC BABEL_BINARY_vu_prepare_p3
GO
~~START~~
binary
0904D000340000000000
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p3
GO

-- Test function f3 (style 2)
SELECT dbo.BABEL_BINARY_vu_prepare_f3()
GO
~~START~~
varbinary
0904D000340000000000
~~END~~

DROP FUNCTION BABEL_BINARY_vu_prepare_f3
GO

-- Test view v4 (VARBINARY)
SELECT * FROM BABEL_BINARY_vu_prepare_v4
GO
~~START~~
varbinary
30393034443030303334
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v4
GO

-- Test procedure p4 (VARBINARY)
EXEC BABEL_BINARY_vu_prepare_p4
GO
~~START~~
varbinary
30393034443030303334
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p4
GO

-- Test function f4 (VARBINARY)
SELECT dbo.BABEL_BINARY_vu_prepare_f4()
GO
~~START~~
varbinary
30393034443030303334
~~END~~

DROP FUNCTION BABEL_BINARY_vu_prepare_f4
GO

-- Test procedure p5 (invalid style - should cause an error)
EXEC BABEL_BINARY_vu_prepare_p5
GO
~~ERROR (Code: 9809)~~

~~ERROR (Message: The style 3 is not supported for conversions from varchar to varbinary.)~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p5
GO

-- Test function f5 (NULL input)
SELECT dbo.BABEL_BINARY_vu_prepare_f5()
GO
~~START~~
varbinary
<NULL>
~~END~~

DROP FUNCTION BABEL_BINARY_vu_prepare_f5
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v5
GO
~~START~~
binary
3078313233
3078373837
3078313233
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v5
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v6
GO
~~START~~
binary
3078313233
3078373837
3078313233
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v6
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v7
GO
~~START~~
binary
3132333441
3738373938
3132333400
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v7
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v8_try
GO
~~START~~
binary
30
30
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v8_try
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v9_try
GO
~~START~~
binary
30
30
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v9_try
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v10_try
GO
~~START~~
binary
31
37
31
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v10_try
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v11
GO
~~START~~
binary
3078313233
3078373837
3078313233
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v11
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v12
GO
~~START~~
binary
3078313233
3078373837
3078313233
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v12
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v13
GO
~~START~~
binary
3078313233
3078373837
3078313233
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v13
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v14_try
GO
~~START~~
binary
30
30
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v14_try
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v15_try
GO
~~START~~
binary
30
30
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v15_try
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v16_try
GO
~~START~~
binary
30
30
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v16_try
GO

EXEC BABEL_BINARY_vu_prepare_p6
GO
~~START~~
binary
1234ABCD00
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p6
GO

EXEC BABEL_BINARY_vu_prepare_p7
GO
~~START~~
binary
3132333441
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p7
GO

EXEC BABEL_BINARY_vu_prepare_p8
GO
~~START~~
binary
1234ABCD00
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p8
GO

EXEC BABEL_BINARY_vu_prepare_p9
GO
~~START~~
binary
1234ABCD00
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p9
GO

EXEC BABEL_BINARY_vu_prepare_p10
GO
~~START~~
binary#!#binary
1234ABCD00#!#5678EF0000
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p10
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v17
GO
~~START~~
binary
3078313233
0000003039
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v17
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v18
GO
~~START~~
binary
30
00
41
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v18
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v19
GO
~~START~~
binary
30
00
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v19
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v20
GO
~~START~~
binary
30
00
30
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v20
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v21
GO
~~START~~
binary
3078313233
3136380000
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v21
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v22
GO
~~START~~
binary
30
31
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v22
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v23
GO
~~START~~
binary
3078313233
1234000000
4142000000
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v23
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v24
GO
~~START~~
binary
30
~~ERROR (Code: 33557097)~~

~~ERROR (Message: cannot cast type varbinary to "binary".)~~

DROP VIEW BABEL_BINARY_vu_prepare_v24
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v26
GO
~~START~~
binary
31
~~ERROR (Code: 33557097)~~

~~ERROR (Message: cannot cast type "decimal" to "binary".)~~

DROP VIEW BABEL_BINARY_vu_prepare_v26
GO

EXEC BABEL_BINARY_vu_prepare_p11
GO
~~START~~
binary#!#binary#!#binary
<NULL>#!#<NULL>#!#<NULL>
~~END~~

DROP PROCEDURE BABEL_BINARY_vu_prepare_p11
GO

SELECT dbo.BABEL_BINARY_vu_prepare_f7()
DROP FUNCTION BABEL_BINARY_vu_prepare_f7
GO
~~START~~
varbinary
~~ERROR (Code: 33557097)~~

~~ERROR (Message: cannot cast type numeric to varbinary)~~


SELECT dbo.BABEL_BINARY_vu_prepare_f8()
DROP FUNCTION BABEL_BINARY_vu_prepare_f8
GO
~~START~~
varbinary
<NULL>
~~END~~


SELECT * FROM BABEL_BINARY_vu_prepare_v27
GO
~~START~~
binary#!#binary#!#binary
3078313233#!#3078313233#!#3132333400
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v27
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v28
GO
~~START~~
binary#!#binary#!#binary
30#!#30#!#31
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v28
GO

SELECT dbo.BABEL_BINARY_vu_prepare_f9()
DROP FUNCTION BABEL_BINARY_vu_prepare_f9
GO
~~START~~
varbinary
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


SELECT dbo.BABEL_BINARY_vu_prepare_f10()
DROP FUNCTION BABEL_BINARY_vu_prepare_f10
GO
~~START~~
varbinary
<NULL>
~~END~~


SELECT * FROM BABEL_BINARY_vu_prepare_v29
GO
~~START~~
binary#!#binary#!#binary#!#binary
0000003039#!#323032332D#!#48656C6C6F#!#1234ABCD00
~~END~~

DROP VIEW BABEL_BINARY_vu_prepare_v29
GO

SELECT * FROM BABEL_BINARY_vu_prepare_v30
GO
~~START~~
binary#!#binary#!#binary#!#binary
~~ERROR (Code: 33557097)~~

~~ERROR (Message: cannot cast type varbinary to "binary".)~~

DROP VIEW BABEL_BINARY_vu_prepare_v30
GO

SELECT * FROM BABEL_BINARY_test_table_compcol
GO
~~START~~
varchar#!#varbinary
0x1234ABCD#!#30783132333441424344
0x787980#!#3078373837393830
0x1234#!#307831323334
~~END~~

DROP TABLE BABEL_BINARY_test_table_compcol
GO

SELECT * FROM BABEL_BINARY_test_table_compcol1
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: relation "babel_binary_test_table_compcol1" does not exist)~~

DROP TABLE BABEL_BINARY_test_table_compcol1
GO
~~ERROR (Code: 3701)~~

~~ERROR (Message: table "babel_binary_test_table_compcol1" does not exist)~~


SELECT * FROM BABEL_BINARY_test_table_compcol2
GO
~~START~~
varchar#!#varbinary
0x1234ABCD#!#30783132333441424344
0x787980#!#3078373837393830
0x1234#!#307831323334
~~END~~

DROP TABLE BABEL_BINARY_test_table_compcol2
GO

SELECT * FROM BABEL_BINARY_test_table_compcol3
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: relation "babel_binary_test_table_compcol3" does not exist)~~

DROP TABLE BABEL_BINARY_test_table_compcol3
GO
~~ERROR (Code: 3701)~~

~~ERROR (Message: table "babel_binary_test_table_compcol3" does not exist)~~



-- Additional test cases
-- 1. Testing style 0 (default, ASCII conversion):
-- even length string
SELECT CONVERT(BINARY(5), '0904D00034', 0)
Go
~~START~~
binary
3039303444
~~END~~


-- odd length string
SELECT CONVERT(BINARY(10), '0904D000341', 0)
Go
~~START~~
binary
30393034443030303334
~~END~~


-- default style selected as 0
SELECT CONVERT(BINARY(5), '0904D00034')
Go
~~START~~
binary
3039303444
~~END~~


-- string with prefix '0x' and even length
SELECT CONVERT(BINARY(10), '0x0904D00034', 0)
Go
~~START~~
binary
30783039303444303030
~~END~~


-- string with prefix '0x' and odd length
SELECT CONVERT(BINARY(10), '0x0904D000341', 0)
Go
~~START~~
binary
30783039303444303030
~~END~~


SELECT CONVERT(BINARY(5), 'Hello', 0)
Go
~~START~~
binary
48656C6C6F
~~END~~


-- padding
SELECT CONVERT(BINARY(20), 'Hello', 0)
Go
~~START~~
binary
48656C6C6F000000000000000000000000000000
~~END~~


-- string with blank spaces
SELECT CONVERT(BINARY(10), 'Hello World', 0)
Go
~~START~~
binary
48656C6C6F20576F726C
~~END~~


-- special characters 
SELECT CONVERT(BINARY(15), '0904D000341!@', 0)
Go
~~START~~
binary
303930344430303033343121400000
~~END~~


-- empty string
SELECT CONVERT(BINARY(5), '', 0)
Go
~~START~~
binary
0000000000
~~END~~





-- 2. Testing style 1 (hexadecimal conversion with '0x' prefix):
-- even length string
SELECT CONVERT(BINARY(5), '0x0904D00034', 1);
Go
~~START~~
binary
0904D00034
~~END~~


-- odd length string (should cause an error)
SELECT CONVERT(BINARY(10), '0x0904D000341', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- string without '0x' prefix (should cause an error)
SELECT CONVERT(BINARY(10), '0904D00034', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- string with '0x' prefix and odd length (should cause an error)
SELECT CONVERT(BINARY(10), '0x0904D000341', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- non-hexadecimal string (should cause an error)
SELECT CONVERT(BINARY(5), 'Hello', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- hexadecimal with padding
SELECT CONVERT(BINARY(20), '0x48656C6C6F', 1)
Go
~~START~~
binary
48656C6C6F000000000000000000000000000000
~~END~~


-- special characters in hexadecimal (should cause an error)
SELECT CONVERT(BINARY(15), '0x0904D000341213440', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- non-hexadecimal characters after '0x' (should cause an error)
SELECT CONVERT(BINARY(16), '0x0904D000341!@', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- odd number of hexadecimal digits (should cause an error)
SELECT CONVERT(BINARY(5), '0x0904D0003', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- empty string (should cause an error)
SELECT CONVERT(BINARY(5), '', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~





-- 3. Testing style 2 (hexadecimal conversion without '0x' prefix):
-- even length string
SELECT CONVERT(BINARY(5), '0904D00034', 2)
Go
~~START~~
binary
0904D00034
~~END~~


-- odd length string (should cause an error)
SELECT CONVERT(BINARY(10), '0904D000341', 2)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: invalid hexadecimal data: odd number of digits)~~


-- string with '0x' prefix (should cause an error)
SELECT CONVERT(BINARY(10), '0x0904D00034', 2)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- hexadecimal with padding
SELECT CONVERT(BINARY(20), '48656C6C6F', 2)
Go
~~START~~
binary
48656C6C6F000000000000000000000000000000
~~END~~


-- non-hexadecimal characters (should cause an error)
SELECT CONVERT(BINARY(16), '0904D000341!@', 2)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: invalid hexadecimal digit: "!")~~


-- empty string
SELECT CONVERT(BINARY(5), '', 2)
Go
~~START~~
binary
0000000000
~~END~~


-- maximum length input (8000 bytes = 16000 hex digits)
SELECT CONVERT(BINARY(8000), REPLICATE('0', 16000), 2)
Go
~~START~~
binary
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
~~END~~





-- Testing null styles and empty strings
-- Style 0 (default, ASCII conversion)
-- Null input
SELECT CONVERT(BINARY(5), NULL, 0)
Go
~~START~~
binary
<NULL>
~~END~~


-- Empty string
SELECT CONVERT(BINARY(5), '', 0)
Go
~~START~~
binary
0000000000
~~END~~


-- Null style
SELECT CONVERT(BINARY(5), '0904D00034', NULL)
Go
~~START~~
binary
<NULL>
~~END~~


-- Empty string with null style
SELECT CONVERT(BINARY(5), '', NULL)
Go
~~START~~
binary
<NULL>
~~END~~



-- Style 1 (hexadecimal conversion with '0x' prefix)
-- Null input
SELECT CONVERT(BINARY(5), NULL, 1)
Go
~~START~~
binary
<NULL>
~~END~~


-- Empty string (should cause an error)
SELECT CONVERT(BINARY(5), '', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- Null style with '0x' prefix 
SELECT CONVERT(BINARY(5), '0x0904D00034', NULL)
Go
~~START~~
binary
<NULL>
~~END~~



-- Style 2 (hexadecimal conversion without '0x' prefix)
-- Null input
SELECT CONVERT(BINARY(5), NULL, 2)
Go
~~START~~
binary
<NULL>
~~END~~


-- Empty string
SELECT CONVERT(BINARY(5), '', 2)
Go
~~START~~
binary
0000000000
~~END~~



-- Additional edge cases
-- Null input with null style
SELECT CONVERT(BINARY(5), NULL, NULL)
Go
~~START~~
binary
<NULL>
~~END~~


-- Empty string with large BINARY size
SELECT CONVERT(BINARY(8000), '', 0)
Go
~~START~~
binary
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
~~END~~


-- Null input with large BINARY size
SELECT CONVERT(BINARY(8000), NULL, 0)
Go
~~START~~
binary
<NULL>
~~END~~


-- Space-only string
SELECT CONVERT(BINARY(5), '     ', 0)
Go
~~START~~
binary
2020202020
~~END~~


SELECT CONVERT(BINARY(5), '     ', 1)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


SELECT CONVERT(BINARY(5), '     ', 2)
Go
~~START~~
binary
0000000000
~~END~~


-- Invalid style
SELECT CONVERT(BINARY(10), '0904D00034', 3);
Go
~~ERROR (Code: 9809)~~

~~ERROR (Message: The style 3 is not supported for conversions from varchar to varbinary.)~~


-- Length greater than maximum allowed length (8000)
SELECT CONVERT(BINARY(8001), '0904D00034', 2)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The size '8001' exceeds the maximum allowed (8000) for 'binary' datatype.)~~


-- Minimum length (1 byte) for BINARY
SELECT CONVERT(BINARY(1), 'A', 0);
Go
~~START~~
binary
41
~~END~~


-- Minimum length (1 byte) for VARBINARY
SELECT CONVERT(VARBINARY(1), 'A', 0);
Go
~~START~~
varbinary
41
~~END~~


-- Negative length for BINARY
SELECT CONVERT(BINARY(-5), '0904D00034', 0);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: syntax error near '(' at line 2 and character position 21)~~


-- Zero length for BINARY
SELECT CONVERT(BINARY(0), '0904D00034', 0);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: length for type varbinary must be at least 1)~~




-- Varbinary
-- 1. Testing style 0 (default, ASCII conversion):
-- even length string
SELECT CONVERT(VARBINARY(10), '0904D00034', 0);
Go
~~START~~
varbinary
30393034443030303334
~~END~~


-- odd length string
SELECT CONVERT(VARBINARY(10), '0904D000341', 0);
Go
~~START~~
varbinary
30393034443030303334
~~END~~


-- default style (should be equivalent to style 0)
SELECT CONVERT(VARBINARY(10), '0904D00034');
Go
~~START~~
varbinary
30393034443030303334
~~END~~


-- string with prefix '0x' and even length
SELECT CONVERT(VARBINARY(10), '0x0904D00034', 0);
Go
~~START~~
varbinary
30783039303444303030
~~END~~


-- string with blank spaces
SELECT CONVERT(VARBINARY(15), 'Hello World', 0);
Go
~~START~~
varbinary
48656C6C6F20576F726C64
~~END~~


-- special characters 
SELECT CONVERT(VARBINARY(15), '0904D000341!@', 0);
Go
~~START~~
varbinary
30393034443030303334312140
~~END~~


-- empty string
SELECT CONVERT(VARBINARY(5), '', 0);
Go
~~START~~
varbinary

~~END~~



-- 2. Testing style 1 (hexadecimal conversion with '0x' prefix):
-- even length string
SELECT CONVERT(VARBINARY(10), '0x0904D00034', 1);
Go
~~START~~
varbinary
0904D00034
~~END~~


-- odd length string (should cause an error)
SELECT CONVERT(VARBINARY(10), '0x0904D000341', 1);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- string without '0x' prefix (should cause an error)
SELECT CONVERT(VARBINARY(10), '0904D00034', 1);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- non-hexadecimal string (should cause an error)
SELECT CONVERT(VARBINARY(10), '0xHello', 1);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~



-- 3. Testing style 2 (hexadecimal conversion without '0x' prefix):
-- even length string
SELECT CONVERT(VARBINARY(10), '0904D00034', 2);
Go
~~START~~
varbinary
0904D00034
~~END~~


-- odd length string (should cause an error)
SELECT CONVERT(VARBINARY(10), '0904D000341', 2);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: invalid hexadecimal data: odd number of digits)~~


-- string with '0x' prefix (should cause an error)
SELECT CONVERT(VARBINARY(10), '0x0904D00034', 2);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Error converting data type varchar to varbinary.)~~


-- non-hexadecimal characters (should cause an error)
SELECT CONVERT(VARBINARY(16), '0904D000341!@', 2);
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: invalid hexadecimal digit: "!")~~


-- empty string
SELECT CONVERT(VARBINARY(5), '', 2);
Go
~~START~~
varbinary

~~END~~



-- 4. Testing with larger sizes and edge cases:
-- maximum length input (8000 bytes = 16000 hex digits)
SELECT CONVERT(VARBINARY(8000), REPLICATE('0', 16000), 2);
Go
~~START~~
varbinary
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
~~END~~


-- NULL input
SELECT CONVERT(VARBINARY(10), NULL, 0);
Go
~~START~~
varbinary
<NULL>
~~END~~


SELECT CONVERT(VARBINARY(10), NULL, 1);
Go
~~START~~
varbinary
<NULL>
~~END~~


SELECT CONVERT(VARBINARY(10), NULL, 2);
Go
~~START~~
varbinary
<NULL>
~~END~~


-- NULL style
SELECT CONVERT(VARBINARY(10), '0904D00034', NULL);
Go
~~START~~
varbinary
<NULL>
~~END~~


-- Invalid style
SELECT CONVERT(VARBINARY(10), '0904D00034', 3);
Go
~~ERROR (Code: 9809)~~

~~ERROR (Message: The style 3 is not supported for conversions from varchar to varbinary.)~~


-- Length greater than maximum allowed length (8000)
SELECT CONVERT(VARBINARY(8001), '0904D00034', 2)
Go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The size '8001' exceeds the maximum allowed (8000) for 'varbinary' datatype.)~~

