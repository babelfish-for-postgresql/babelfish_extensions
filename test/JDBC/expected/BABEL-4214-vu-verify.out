-- DATETIME cases
EXEC babel_4214_datetime_to_int_proc
GO
~~START~~
int
9
~~END~~


SELECT babel_4214_datetime_to_int_function()
GO
~~START~~
int
9
~~END~~


SELECT CONVERT(BIT, ISNULL(CAST('1900-01-10 11:00:50.677' AS DATETIME), 0));
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 11:00:50.699' AS DATETIME) AS FLOAT);
GO
~~START~~
float
9.458920138888889
~~END~~


SELECT CAST(CAST('1900-01-10 11:00:50.699' AS DATETIME) AS FLOAT) +.999999;
GO
~~START~~
float
10.45891913888889
~~END~~


SELECT CAST(CAST(CAST('1900-01-10 11:00:50.699' AS DATETIME) AS FLOAT) AS DATETIME);
GO
~~START~~
datetime
1900-01-10 11:00:50.7
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST('1910-01-10 12:56:50.699' AS DATETIME) AS SMALLINT);
GO
~~START~~
smallint
3662
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS INT);
GO
~~START~~
int
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS BIGINT);
GO
~~START~~
bigint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS REAL);
GO
~~START~~
real
9.539475
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS FLOAT);
GO
~~START~~
float
9.539475694444445
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
9.539475694444445
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
9.5395
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
9.539476
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS DECIMAL(18,5));
GO
~~START~~
numeric
9.53948
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS INT);
GO
~~START~~
int
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS BIGINT);
GO
~~START~~
bigint
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS REAL);
GO
~~START~~
real
44925.54
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS FLOAT);
GO
~~START~~
float
44925.539475694444
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
44925.539475694444
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
44925.5395
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
44925.539476
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS DECIMAL(18,5));
GO
~~START~~
numeric
44925.53948
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST(CAST('1900-01-10 12:56:50.699' AS DATETIME) AS sql_variant) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST(CAST('1910-01-10 12:56:50.699' AS DATETIME) AS sql_variant) AS SMALLINT);
GO
~~START~~
smallint
3662
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS INT);
GO
~~START~~
int
44926
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS BIGINT);
GO
~~START~~
bigint
44926
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS REAL);
GO
~~START~~
real
44925.54
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS FLOAT);
GO
~~START~~
float
44925.539475694444
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS DOUBLE PRECISION);
GO
~~START~~
float
44925.539475694444
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS NUMERIC(18,6));
GO
~~START~~
numeric
44925.539476
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS DATETIME) AS sql_variant) AS DECIMAL(18,5));
GO
~~START~~
numeric
44925.53948
~~END~~



-- Negative dates, i.e. dates before 1900-01-01
SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1899-12-21 12:56:50.677' AS DATETIME) AS TINYINT);
GO
~~START~~
tinyint
~~ERROR (Code: 220)~~

~~ERROR (Message: value for domain tinyint violates check constraint "tinyint_check")~~


SELECT CAST(CAST('1890-12-21 12:56:50.677' AS DATETIME) AS SMALLINT);
GO
~~START~~
smallint
-3297
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS INT);
GO
~~START~~
int
-3651
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS BIGINT);
GO
~~START~~
bigint
-3651
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS REAL);
GO
~~START~~
real
-3651.4604
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS FLOAT);
GO
~~START~~
float
-3651.460524421296
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
-3651.460524421296
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
-3651.4605
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
-3651.460524
~~END~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS DATETIME) AS DECIMAL(18,5));
GO
~~START~~
numeric
-3651.46052
~~END~~


-- SMALLDATETIME cases
EXEC babel_4214_smalldatetime_to_int_proc
GO
~~START~~
int
9
~~END~~


SELECT babel_4214_smalldatetime_to_int_function();
GO
~~START~~
int
9
~~END~~


SELECT CONVERT(BIT, ISNULL(CAST('1900-01-10 11:00:50.699' AS SMALLDATETIME), 0));
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 11:00:50.699' AS SMALLDATETIME) AS FLOAT);
GO
~~START~~
float
9.459027777777777
~~END~~


SELECT CAST(CAST('1900-01-10 11:00:50.699' AS SMALLDATETIME) AS FLOAT) +.999999;
GO
~~START~~
float
10.459026777777778
~~END~~


SELECT CAST(CAST(CAST('1900-01-10 11:00:50.699' AS SMALLDATETIME) AS FLOAT) AS SMALLDATETIME);
GO
~~START~~
smalldatetime
1900-01-10 11:01:00.0
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS SMALLINT);
GO
~~START~~
smallint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS INT);
GO
~~START~~
int
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS BIGINT);
GO
~~START~~
bigint
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS REAL);
GO
~~START~~
real
9.539583
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS FLOAT);
GO
~~START~~
float
9.539583333333333
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
9.539583333333333
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS NUMERIC);
GO
~~START~~
numeric
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
9.5396
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
9.539583
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS NUMERIC(18,10));
GO
~~START~~
numeric
9.5395833333
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS DECIMAL);
GO
~~START~~
numeric
10
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS DECIMAL(18,5));
GO
~~START~~
numeric
9.53958
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST('1900-01-10 12:56:50.699' AS SMALLDATETIME) AS TINYINT);
GO
~~START~~
tinyint
10
~~END~~


SELECT CAST(CAST('1910-01-10 12:56:50.699' AS SMALLDATETIME) AS SMALLINT);
GO
~~START~~
smallint
3662
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS INT);
GO
~~START~~
int
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS BIGINT);
GO
~~START~~
bigint
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS REAL);
GO
~~START~~
real
44925.54
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS FLOAT);
GO
~~START~~
float
44925.53958333333
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS DOUBLE PRECISION);
GO
~~START~~
float
44925.53958333333
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS NUMERIC);
GO
~~START~~
numeric
44926
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS NUMERIC(18,4));
GO
~~START~~
numeric
44925.5396
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS NUMERIC(18,6));
GO
~~START~~
numeric
44925.539583
~~END~~


SELECT CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS DECIMAL(18,5));
GO
~~START~~
numeric
44925.53958
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS BIT);
GO
~~START~~
bit
1
~~END~~


SELECT CAST(CAST(CAST('1900-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS TINYINT);
GO
~~START~~
tinyint
1
~~END~~


SELECT CAST(CAST(CAST('1910-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS SMALLINT);
GO
~~START~~
smallint
3653
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS INT);
GO
~~START~~
int
44926
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS BIGINT);
GO
~~START~~
bigint
44926
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS REAL);
GO
~~START~~
real
44925.54
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS FLOAT);
GO
~~START~~
float
44925.53958333333
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS DOUBLE PRECISION);
GO
~~START~~
float
44925.53958333333
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS NUMERIC(18,6));
GO
~~START~~
numeric
44925.539583
~~END~~


SELECT CAST(CAST(CAST('2023-01-01 12:56:50.699' AS SMALLDATETIME) AS sql_variant) AS DECIMAL(18,5));
GO
~~START~~
numeric
44925.53958
~~END~~


-- Negative dates are not supported by SMALLDATETIME, i.e. dates before 1900-01-01
SELECT CAST(CAST('1890-01-01 12:56:50.677' AS SMALLDATETIME) AS INT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS SMALLDATETIME) AS BIGINT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS SMALLDATETIME) AS FLOAT);
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~


SELECT CAST(CAST('1890-01-01 12:56:50.677' AS SMALLDATETIME) AS NUMERIC(18,6));
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: data out of range for smalldatetime)~~

