-- psql user=test_user password=12345678
-- Renaming bbf role for a non-supueruser should fail
ALTER ROLE master_alterrole_test_role RENAME TO master_alterrole_test_role1;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


-- Give a bbf role the ability to create other roles, login, nologin and new databases should fail
ALTER ROLE master_alterrole_test_role LOGIN;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


ALTER ROLE master_alterrole_test_role NOLOGIN;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


ALTER ROLE master_alterrole_test_role CREATEDB;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


ALTER ROLE master_alterrole_test_role CREATEROLE CREATEDB;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


-- Change bbf role's password should fail
ALTER ROLE master_alterrole_test_role PASSWORD '123';
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


ALTER ROLE master_alterrole_test_role WITH PASSWORD '123';
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


ALTER ROLE master_alterrole_test_role WITH PASSWORD NULL;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


-- Make a password valid until a particular period for bbf role should fail
ALTER ROLE master_alterrole_test_role VALID UNTIL 'NOV 4 12:00:00 2022 +1';
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


ALTER ROLE master_alterrole_test_role VALID UNTIL 'infinity';
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


-- Give a bbf role a non-default setting of the x parameter should fail
ALTER ROLE master_alterrole_test_role SET x =false;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~


-- Give a bbf role a non-default, database-specific setting of the x parameter should fail
ALTER ROLE master_alterrole_test_role IN DATABASE postgres set x=false;
GO
~~ERROR (Code: 0)~~

~~ERROR (Message: ERROR: Babelfish-created users/roles cannot be dropped or altered outside of a Babelfish session
    Server SQLState: 42501)~~

