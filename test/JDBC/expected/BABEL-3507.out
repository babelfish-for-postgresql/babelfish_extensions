CREATE TABLE avg_testing(
sumbigint BIGINT, sumint INT , sumsmallint SMALLINT , sumtinyint TINYINT )
GO

INSERT INTO avg_testing VALUES (9223372036854775807,2147483647,32767,255)
INSERT INTO avg_testing VALUES (9223372036854775807,2147483647,32767,255)
GO
~~ROW COUNT: 1~~

~~ROW COUNT: 1~~


select avg(sumbigint) from avg_testing
GO
~~START~~
bigint
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Arithmetic overflow error converting expression to data type bigint.)~~


select avg(sumint) from avg_testing
GO
~~START~~
int
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Arithmetic overflow error converting expression to data type int.)~~


drop table avg_testing
go

CREATE TABLE avg_testing2(
sumbigint BIGINT, sumint INT , sumsmallint SMALLINT , sumtinyint TINYINT )
GO

select avg(sumbigint) from avg_testing2
GO
~~START~~
bigint
<NULL>
~~END~~

select avg(sumint) from avg_testing2
GO
~~START~~
int
<NULL>
~~END~~

select avg(sumsmallint) from avg_testing2
GO
~~START~~
int
<NULL>
~~END~~

select avg(sumtinyint) from avg_testing2
GO
~~START~~
int
<NULL>
~~END~~


drop table avg_testing2
go

CREATE TABLE avg_testing3(
sumbigint BIGINT, sumint INT , sumsmallint SMALLINT , sumtinyint TINYINT )
GO

INSERT INTO avg_testing3 VALUES(16,8,4,2)
INSERT INTO avg_testing3 VALUES(2,4,8,16)
GO
~~ROW COUNT: 1~~

~~ROW COUNT: 1~~


SELECT avg( sumbigint ) AS sum_int FROM avg_testing3
GO
~~START~~
bigint
9
~~END~~


SELECT avg( sumint ) AS sum_int FROM avg_testing3
GO
~~START~~
int
6
~~END~~


SELECT avg( sumsmallint ) AS sum_smallintint FROM avg_testing3
GO
~~START~~
int
6
~~END~~


SELECT avg( sumtinyint ) AS sum_tinyint FROM avg_testing3
GO
~~START~~
int
9
~~END~~



SELECT 
	cast(pg_typeof( SUM( sumbigint ) ) as varchar(48) )  as sum_bigint 
	, cast(pg_typeof( SUM( sumint ) ) as varchar(48) )  as sum_int 
	, cast(pg_typeof( SUM( sumsmallint ) ) as varchar(48) )  as sum_smallint 
	, cast(pg_typeof( SUM( sumtinyint ) ) as varchar(48) )  as sum_tinyint 
FROM avg_testing3
GO
~~START~~
varchar#!#varchar#!#varchar#!#varchar
bigint#!#integer#!#integer#!#integer
~~END~~


drop table avg_testing3
go
