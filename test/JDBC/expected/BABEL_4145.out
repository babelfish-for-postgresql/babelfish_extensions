-- psql
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_repeatable_read_isolation" = "default";
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_serializable_isolation" = "default";
GO

-- tsql
SELECT set_config('babelfishpg_tsql.babelfish_repeatable_read_isolation','pg_isolation',false)
SELECT set_config('babelfishpg_tsql.babelfish_serializable_isolation','pg_isolation',false)
GO
~~START~~
text
on
~~END~~

~~START~~
text
on
~~END~~

SELECT current_setting('babelfishpg_tsql.babelfish_repeatable_read_isolation');
SELECT current_setting('babelfishpg_tsql.babelfish_serializable_isolation');
GO
~~START~~
text
on
~~END~~

~~START~~
text
on
~~END~~

-- terminate-tsql-conn

-- tsql
SELECT current_setting('babelfishpg_tsql.babelfish_repeatable_read_isolation');
SELECT current_setting('babelfishpg_tsql.babelfish_serializable_isolation');
GO
~~START~~
text
off
~~END~~

~~START~~
text
off
~~END~~

SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Repeatable read is not supported by default, set configuration parameter 'babelfish_repeatable_read_isolation' to 'pg_isolation' to get PG repeatable read)~~

SELECT current_setting('transaction_isolation');
GO
~~START~~
text
read committed
~~END~~

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Serializable is not supported by default, set configuration parameter 'babelfish_serializable_isolation' to 'pg_isolation' to get PG serializable)~~

SELECT current_setting('transaction_isolation');
GO
~~START~~
text
read committed
~~END~~

-- terminate-tsql-conn

-- psql
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_repeatable_read_isolation" = "pg_isolation";
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_serializable_isolation" = "default";
GO

-- tsql
SELECT current_setting('babelfishpg_tsql.babelfish_repeatable_read_isolation');
SELECT current_setting('babelfishpg_tsql.babelfish_serializable_isolation');
GO
~~START~~
text
on
~~END~~

~~START~~
text
off
~~END~~

SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
GO
SELECT current_setting('transaction_isolation');
GO
~~START~~
text
repeatable read
~~END~~

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Serializable is not supported by default, set configuration parameter 'babelfish_serializable_isolation' to 'pg_isolation' to get PG serializable)~~

SELECT current_setting('transaction_isolation');
GO
~~START~~
text
repeatable read
~~END~~

-- terminate-tsql-conn

-- psql
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_repeatable_read_isolation" = "default";
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_serializable_isolation" = "pg_isolation";
GO

-- tsql
SELECT current_setting('babelfishpg_tsql.babelfish_repeatable_read_isolation');
SELECT current_setting('babelfishpg_tsql.babelfish_serializable_isolation');
GO
~~START~~
text
off
~~END~~

~~START~~
text
on
~~END~~

SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Repeatable read is not supported by default, set configuration parameter 'babelfish_repeatable_read_isolation' to 'pg_isolation' to get PG repeatable read)~~

SELECT current_setting('transaction_isolation');
GO
~~START~~
text
read committed
~~END~~

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
GO
SELECT current_setting('transaction_isolation');
GO
~~START~~
text
serializable
~~END~~

-- terminate-tsql-conn

-- psql
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_repeatable_read_isolation" = "pg_isolation";
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_serializable_isolation" = "pg_isolation";
GO

-- tsql
SELECT current_setting('babelfishpg_tsql.babelfish_repeatable_read_isolation');
SELECT current_setting('babelfishpg_tsql.babelfish_serializable_isolation');
GO
~~START~~
text
on
~~END~~

~~START~~
text
on
~~END~~

SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
GO
SELECT current_setting('transaction_isolation');
GO
~~START~~
text
repeatable read
~~END~~

SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
GO
SELECT current_setting('transaction_isolation');
GO
~~START~~
text
serializable
~~END~~

-- terminate-tsql-conn

-- psql
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_repeatable_read_isolation" = "default";
ALTER DATABASE "jdbc_testdb" SET "babelfishpg_tsql.babelfish_serializable_isolation" = "default";
GO
