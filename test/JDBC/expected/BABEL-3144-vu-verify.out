-- throws an error
SELECT SUM( sumbigint ) AS sum_bigint FROM babel_3144_vu_preppare_t1
GO
~~START~~
bigint
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Arithmetic overflow error converting expression to data type bigint.)~~


SELECT SUM( sumint ) AS sum_int FROM babel_3144_vu_preppare_t1
GO
~~START~~
int
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Arithmetic overflow error converting expression to data type int.)~~


-- empty table return value should be NULL
SELECT SUM( sumbigint ) AS sum_bigint FROM babel_3144_vu_preppare_t2
GO
~~START~~
bigint
<NULL>
~~END~~


SELECT SUM( sumint ) AS sum_int FROM babel_3144_vu_preppare_t2
GO
~~START~~
int
<NULL>
~~END~~


SELECT SUM( sumsmallint ) AS sum_smallintint FROM babel_3144_vu_preppare_t2
GO
~~START~~
int
<NULL>
~~END~~


SELECT SUM( sumtinyint ) AS sum_tinyint FROM babel_3144_vu_preppare_t2
GO
~~START~~
int
<NULL>
~~END~~


SELECT SUM( sumbigint ) AS sum_bigint FROM babel_3144_vu_preppare_t3
GO
~~START~~
bigint
18
~~END~~


SELECT SUM( sumint ) AS sum_int FROM babel_3144_vu_preppare_t3
GO
~~START~~
int
12
~~END~~


SELECT SUM( sumsmallint ) AS sum_smallintint FROM babel_3144_vu_preppare_t3
GO
~~START~~
int
12
~~END~~


SELECT SUM( sumtinyint ) AS sum_tinyint FROM babel_3144_vu_preppare_t3
GO
~~START~~
int
18
~~END~~


SELECT 
	cast(pg_typeof( SUM( sumbigint ) ) as varchar(48) )  as sum_bigint 
	, cast(pg_typeof( SUM( sumint ) ) as varchar(48) )  as sum_int 
	, cast(pg_typeof( SUM( sumsmallint ) ) as varchar(48) )  as sum_smallint 
	, cast(pg_typeof( SUM( sumtinyint ) ) as varchar(48) )  as sum_tinyint 
FROM babel_3144_vu_preppare_t3
GO
~~START~~
varchar#!#varchar#!#varchar#!#varchar
bigint#!#integer#!#integer#!#integer
~~END~~


DROP TABLE babel_3144_vu_preppare_t1
DROP TABLE babel_3144_vu_preppare_t2
DROP TABLE babel_3144_vu_preppare_t3
GO
