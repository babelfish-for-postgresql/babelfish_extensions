EXEC babel_2812_vu_p1 '17:30:00', '20211212';
GO
~~START~~
datetime
2021-12-12 17:30:00.0
~~END~~


EXEC babel_2812_vu_p2 '17:30:00', '20211212';
GO
~~START~~
datetime
2021-12-12 17:30:00.0
~~END~~


EXEC babel_2812_vu_p3 '17:30:00', '20211212';
GO
~~START~~
datetime
2021-12-11 06:30:00.0
~~END~~


EXEC babel_2812_vu_p4 '17:30:00', '20211212';
GO
~~START~~
datetime
2021-12-12 17:30:00.0
~~END~~


SELECT * FROM babel_2812_vu_v1
GO
~~START~~
int
-9
~~END~~


SELECT * FROM babel_2812_vu_v2
GO
~~START~~
datetime#!#datetime
2021-12-12 17:30:00.0#!#2021-12-11 06:30:00.0
~~END~~


SELECT * FROM babel_2812_vu_v3
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime
2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2021-12-13 00:00:00.0#!#2021-12-13 00:00:00.0#!#2022-02-06 00:00:00.0#!#2022-02-06 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-06 00:00:00.0#!#2022-02-06 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v4
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime
2021-10-18 00:00:00.0#!#1778-03-16 00:00:00.0#!#2021-12-11 00:00:00.0#!#1778-01-21 00:00:00.0#!#2021-10-17 00:00:00.0#!#1778-03-17 00:00:00.0#!#2021-10-18 00:00:00.0#!#1778-03-16 00:00:00.0#!#2021-10-17 10:48:00.0#!#1778-03-16 13:12:00.0#!#2021-10-17 00:00:00.0#!#1778-03-17 00:00:00.0#!#2021-10-18 00:00:00.0#!#1778-03-16 00:00:00.0#!#2021-10-17 10:48:00.0#!#1778-03-16 13:12:00.0#!#2021-10-18 00:00:00.0#!#1778-03-16 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v5
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:11:59.933#!#2022-02-05 13:11:59.933
~~END~~


SELECT * FROM babel_2812_vu_v6
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-10-17 10:48:00.0#!#1778-03-16 13:12:00.0#!#2021-10-17 10:48:00.067#!#1778-03-16 13:11:59.933
~~END~~


SELECT * FROM babel_2812_vu_v7
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v8
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0#!#2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v9
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v10
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0#!#2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v11
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v12
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime
2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0#!#2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v13
GO
~~START~~
smalldatetime#!#smalldatetime
2021-12-12 17:30:00.0#!#2021-12-11 06:30:00.0
~~END~~


SELECT * FROM babel_2812_vu_v14
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2021-12-13 00:00:00.0#!#2021-12-13 00:00:00.0#!#2022-02-06 00:00:00.0#!#2022-02-06 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-06 00:00:00.0#!#2022-02-06 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v15
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-10-18 00:00:00.0#!#1900-02-23 00:00:00.0#!#2021-12-11 00:00:00.0#!#1900-01-02 00:00:00.0#!#2021-10-17 00:00:00.0#!#1900-02-24 00:00:00.0#!#2021-10-18 00:00:00.0#!#1900-02-23 00:00:00.0#!#2021-10-17 10:48:00.0#!#1900-02-23 13:12:00.0#!#2021-10-17 00:00:00.0#!#1900-02-24 00:00:00.0#!#2021-10-18 00:00:00.0#!#1900-02-23 00:00:00.0#!#2021-10-17 10:48:00.0#!#1900-02-23 13:12:00.0#!#2021-10-18 00:00:00.0#!#1900-02-23 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v16
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0
~~END~~


SELECT * FROM babel_2812_vu_v17
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-10-17 10:48:00.0#!#1900-02-23 13:12:00.0#!#2021-10-17 10:48:00.0#!#1900-02-23 13:12:00.0
~~END~~


SELECT * FROM babel_2812_vu_v18
GO
~~START~~
smalldatetime#!#smalldatetime#!#datetime#!#datetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v19
GO
~~START~~
smalldatetime#!#smalldatetime#!#datetime#!#datetime
2021-12-10 00:00:00.0#!#2021-12-10 00:00:00.0#!#2021-12-10 00:00:00.0#!#2021-12-10 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v20
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v21
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-12-10 00:00:00.0#!#1900-01-01 00:00:00.0#!#2021-12-10 00:00:00.0#!#1900-01-01 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v22
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v23
GO
~~START~~
smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-12-10 00:00:00.0#!#1900-01-01 00:00:00.0#!#2021-12-10 00:00:00.0#!#1900-01-01 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v24
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0#!#2021-12-14 00:00:00.0#!#2021-12-14 00:00:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 13:12:00.0#!#2022-02-05 00:00:00.0#!#2022-02-05 00:00:00.0
~~END~~


SELECT * FROM babel_2812_vu_v25
GO
~~START~~
datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#datetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime#!#smalldatetime
2021-12-10 00:00:00.0#!#1778-01-22 00:00:00.0#!#2021-10-17 10:48:00.0#!#1778-03-16 13:12:00.0#!#2021-10-18 00:00:00.0#!#1778-03-16 00:00:00.0#!#2021-12-10 00:00:00.0#!#1900-01-01 00:00:00.0#!#2021-10-17 10:48:00.0#!#1900-02-23 13:12:00.0#!#2021-10-18 00:00:00.0#!#1900-02-23 00:00:00.0
~~END~~


-- test DATETIME + other date and time data types (should not work)
SELECT (CAST('20211212' AS DATETIME) + CAST('19000103' AS DATE))
GO
~~START~~
datetime
2021-12-14 00:00:00.0
~~END~~


SELECT (CAST('20211212' AS DATETIME) + CAST('19000103' AS TEXT))
GO
~~START~~
varchar
2021-12-12 00:00:0019000103
~~END~~


-- overflow for datetime, should error
SELECT  (CAST('1753-01-01' AS DATETIME) + CAST(2000000000 AS INT))
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: timestamp out of range)~~


SELECT  (CAST('1753-01-01' AS DATETIME) + CAST(4000000000 AS BIGINT))
GO
~~ERROR (Code: 8115)~~

~~ERROR (Message: integer out of range)~~


-- Test DATEDIFF() with DATE type for different dateparts
SELECT datediff(year, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
1
~~END~~

SELECT datediff(quarter, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
4
~~END~~

SELECT datediff(month, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
12
~~END~~

-- datediff(week) is not 100% the same as SQL Server, needs to be fixed - should return 52
SELECT datediff(week, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
51
~~END~~

SELECT datediff(y, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
363
~~END~~

SELECT datediff(day, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
363
~~END~~

SELECT datediff(hour, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
8712
~~END~~

SELECT datediff(minute, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
522720
~~END~~

SELECT datediff(second, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~START~~
int
31363200
~~END~~

-- should overflow
SELECT datediff(millisecond, CAST('2015-12-31' as date), cast('2016-12-28' as date));
GO
~~ERROR (Code: 8115)~~

~~ERROR (Message: integer out of range)~~

-- smaller interval for millisecond
SELECT datediff(millisecond, CAST('2016-12-27' as date), cast('2016-12-28' as date));
GO
~~START~~
int
86400000
~~END~~

-- should overflow
SELECT datediff(microsecond, CAST('2016-12-27' as date), cast('2016-12-28' as date));
GO
~~ERROR (Code: 8115)~~

~~ERROR (Message: integer out of range)~~

-- microsecond and nanosecond can only handle diff of 0 for date type
SELECT datediff(microsecond, CAST('2016-12-28' as date), cast('2016-12-28' as date));
GO
~~START~~
int
0
~~END~~

SELECT datediff(nanosecond, CAST('2016-12-28' as date), cast('2016-12-28' as date));
GO
~~START~~
int
0
~~END~~

