-- Test to check ESCAPE null case (ESCAPE null means no ESCAPE char used)
select 1 where 'ABCD' LIKE 'AB[C]D' ESCAPE '';
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

select 1 where 'cbc' LIKE '[c-a]bc' ESCAPE '';
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

select 1 where 'abc' LIKE '[0-a]bc' ESCAPE '';
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

select 1 where 'abc' LIKE '[abc]bc' ESCAPE '';
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

select 1 where 'abc' LIKE '[a-c]bc' ESCAPE '';
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

select 1 where 'bbc' LIKE '[a-c]bc' ESCAPE '';
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

select a, b from testvikasprj where testvikasprj.a LIKE testvikasprj.b ESCAPE '';
go
~~START~~
varchar#!#varchar
~~ERROR (Code: 33557097)~~

~~ERROR (Message: The invalid escape character "" was specified in a LIKE predicate.)~~

-- Test to check ESCAPE null case (ESCAPE null means no ESCAPE char used)
select 1 where 'ABCD' LIKE 'AB[C]D' ESCAPE null;
go
~~START~~
int
1
~~END~~

select 1 where 'cbc' LIKE '[c-a]bc' ESCAPE null;
go
~~START~~
int
~~END~~

select 1 where 'abc' LIKE '[0-a]bc' ESCAPE null;
go
~~START~~
int
1
~~END~~

select 1 where 'abc' LIKE '[abc]bc' ESCAPE null;
go
~~START~~
int
1
~~END~~

select 1 where 'abc' LIKE '[a-c]bc' ESCAPE null;
go
~~START~~
int
1
~~END~~

select 1 where 'bbc' LIKE '[a-c]bc' ESCAPE null;
go
~~START~~
int
1
~~END~~

select a, b from testvikasprj where testvikasprj.a LIKE testvikasprj.b ESCAPE null;
go
~~START~~
varchar#!#varchar
abc#!#abc
~~END~~

