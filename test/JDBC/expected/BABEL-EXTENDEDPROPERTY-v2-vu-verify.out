-- psql
do
$$ declare dbname text;
begin
    select setting from pg_settings where name like 'babelfishpg_tsql.database_name' into dbname;
    EXECUTE 'GRANT CREATE ON DATABASE ' || quote_ident(dbname) || ' TO babel_extended_properties_db_guest';
end $$;
GO

-- tsql
-- reset the login password
ALTER LOGIN owner WITH PASSWORD = '12345678';
GO

-- tsql user=owner password=12345678
USE babel_extended_properties_db
GO

-- should fail
EXEC babel_sp_addextendedproperty 'wrong param', 'test', '', NULL
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: An invalid parameter or option was specified for procedure 'sp_addextendedproperty'.)~~


EXEC babel_sp_updateextendedproperty 'wrong param', 'test', NULL, NULL, '', ''
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: An invalid parameter or option was specified for procedure 'sp_updateextendedproperty'.)~~


EXEC babel_sp_dropextendedproperty 'wrong param', 'test', '', '', NULL, NULL, '', ''
GO
~~ERROR (Code: 8144)~~

~~ERROR (Message: procedure babel_sp_dropextendedproperty has too many arguments specified.)~~


EXEC babel_sp_updateextendedproperty 'non-existing property', 'test'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Property cannot be updated or deleted. Property 'non-existing property' does not exist for 'object specified'.)~~


EXEC babel_sp_dropextendedproperty 'non-existing property'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Property cannot be updated or deleted. Property 'non-existing property' does not exist for 'object specified'.)~~


EXEC babel_sp_addextendedproperty 'already existing property', 'test'
GO

EXEC babel_sp_addextendedproperty 'already existing property', 'test'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Property cannot be added. Property 'already existing property' already exists for 'object specified'.)~~


EXEC babel_sp_dropextendedproperty 'wrong param'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Property cannot be updated or deleted. Property 'wrong param' does not exist for 'object specified'.)~~


EXEC babel_sp_dropextendedproperty 'wrong param', NULL
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Property cannot be updated or deleted. Property 'wrong param' does not exist for 'object specified'.)~~


EXEC babel_sp_dropextendedproperty 'already existing property'
GO

SELECT * FROM babel_fn_listextendedproperty(NULL)
GO
~~ERROR (Code: 201)~~

~~ERROR (Message: function babel_fn_listextendedproperty expects parameter "@level0type", which was not supplied.)~~


-- database
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
~~END~~


EXEC babel_sp_addextendedproperty 'database property1', 'database property1 before'
GO

EXEC babel_sp_addextendedproperty 'database property2', 'database property2 before'
GO

EXEC babel_fn_listextendedproperty NULL, NULL, NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
<NULL>#!#<NULL>#!#database property1#!#database property1 before
<NULL>#!#<NULL>#!#database property2#!#database property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'database property1', NULL, NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
<NULL>#!#<NULL>#!#database property1#!#database property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 before
0#!#DATABASE#!#0#!#0#!#database property2#!#database property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'database property1', 'database property1 after'
GO

EXEC babel_sp_updateextendedproperty 'database property2', 'database property2 after'
GO

EXEC babel_fn_listextendedproperty NULL, NULL, NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
<NULL>#!#<NULL>#!#database property1#!#database property1 after
<NULL>#!#<NULL>#!#database property2#!#database property2 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
0#!#DATABASE#!#0#!#0#!#database property2#!#database property2 after
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'database property2'
GO

EXEC babel_fn_listextendedproperty NULL, NULL, NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
<NULL>#!#<NULL>#!#database property1#!#database property1 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- schema
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
~~END~~


CREATE SCHEMA babel_extended_properties_schema1
GO

EXEC babel_sp_addextendedproperty 'schema property1', 'schema property1 before', 'schema', 'babel_extended_properties_schema1'
GO

EXEC babel_sp_addextendedproperty 'schema property2', 'schema property2 before', 'schema', 'babel_extended_properties_schema1'
GO

CREATE SCHEMA BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name
GO

EXEC babel_sp_addextendedproperty 'schema property1', 'schema property1 before', 'schema', 'BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_sp_addextendedproperty 'schema property2', 'schema property2 before', 'schema', 'BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SCHEMA#!#babel_extended_properties_schema1#!#schema property1#!#schema property1 before
SCHEMA#!#babel_extended_properties_schema1#!#schema property2#!#schema property2 before
SCHEMA#!#BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#schema property1#!#schema property1 before
SCHEMA#!#BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#schema property2#!#schema property2 before
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SCHEMA#!#babel_extended_properties_schema1#!#schema property1#!#schema property1 before
SCHEMA#!#babel_extended_properties_schema1#!#schema property2#!#schema property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'schema property1', 'schema', 'babel_extended_properties_schema1', NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SCHEMA#!#babel_extended_properties_schema1#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'schema property1', 'schema', NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SCHEMA#!#babel_extended_properties_schema1#!#schema property1#!#schema property1 before
SCHEMA#!#BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#schema property1#!#schema property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'schema property1', 'schema property1 after', 'schema', 'babel_extended_properties_schema1'
GO

EXEC babel_sp_updateextendedproperty 'schema property2', 'schema property2 after', 'schema', 'BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SCHEMA#!#babel_extended_properties_schema1#!#schema property1#!#schema property1 after
SCHEMA#!#babel_extended_properties_schema1#!#schema property2#!#schema property2 before
SCHEMA#!#BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#schema property1#!#schema property1 before
SCHEMA#!#BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#schema property2#!#schema property2 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 after
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'schema property2', 'schema', 'BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, NULL, NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SCHEMA#!#babel_extended_properties_schema1#!#schema property1#!#schema property1 after
SCHEMA#!#babel_extended_properties_schema1#!#schema property2#!#schema property2 before
SCHEMA#!#BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#schema property1#!#schema property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- table
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


CREATE TABLE babel_extended_properties_schema1.babel_extended_properties_table1(id int, name varchar);
GO

EXEC babel_sp_addextendedproperty 'table property1', 'table property1 before', 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1'
GO

EXEC babel_sp_addextendedproperty 'table property2', 'table property2 before', 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1'
GO

CREATE TABLE babel_extended_properties_schema1.BABEL_extended_properties_table2(Id int, LONG_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name varchar);
GO

EXEC babel_sp_addextendedproperty 'table property1', 'table property1 before', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table2'
GO

EXEC babel_sp_addextendedproperty 'table property2', 'table property2 before', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table2'
GO

CREATE TABLE babel_extended_properties_schema1.BABEL_extended_properties_table3_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name(id int, name varchar);
GO

EXEC babel_sp_addextendedproperty 'table property1', 'table property1 before', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table3_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_sp_addextendedproperty 'table property2', 'table property2 before', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table3_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, 'table', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 before
TABLE#!#babel_extended_properties_table1#!#table property2#!#table property2 before
TABLE#!#BABEL_extended_properties_table2#!#table property1#!#table property1 before
TABLE#!#BABEL_extended_properties_table2#!#table property2#!#table property2 before
TABLE#!#babel_extended_properties_table783e9cd01e68686d0d071a20f0d03eba#!#table property1#!#table property1 before
TABLE#!#babel_extended_properties_table783e9cd01e68686d0d071a20f0d03eba#!#table property2#!#table property2 before
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 before
TABLE#!#babel_extended_properties_table1#!#table property2#!#table property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'table property1', 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 before
TABLE#!#BABEL_extended_properties_table2#!#table property1#!#table property1 before
TABLE#!#babel_extended_properties_table783e9cd01e68686d0d071a20f0d03eba#!#table property1#!#table property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'table property1', 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'table property1', 'table property1 after', 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1'
GO

EXEC babel_sp_updateextendedproperty 'table property2', 'table property2 after', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table2'
GO

EXEC babel_sp_updateextendedproperty 'table property1', 'table property1 after', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table3_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 after
TABLE#!#babel_extended_properties_table1#!#table property2#!#table property2 before
TABLE#!#BABEL_extended_properties_table2#!#table property1#!#table property1 before
TABLE#!#BABEL_extended_properties_table2#!#table property2#!#table property2 after
TABLE#!#babel_extended_properties_table783e9cd01e68686d0d071a20f0d03eba#!#table property1#!#table property1 after
TABLE#!#babel_extended_properties_table783e9cd01e68686d0d071a20f0d03eba#!#table property2#!#table property2 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'table property2', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table2'
GO

EXEC babel_sp_dropextendedproperty 'table property1', 'schema', 'babel_extended_properties_schema1', 'table', 'BABEL_extended_properties_table3_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 after
TABLE#!#babel_extended_properties_table1#!#table property2#!#table property2 before
TABLE#!#BABEL_extended_properties_table2#!#table property1#!#table property1 before
TABLE#!#babel_extended_properties_table783e9cd01e68686d0d071a20f0d03eba#!#table property2#!#table property2 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP TABLE babel_extended_properties_schema1.BABEL_extended_properties_table3_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 after
TABLE#!#babel_extended_properties_table1#!#table property2#!#table property2 before
TABLE#!#BABEL_extended_properties_table2#!#table property1#!#table property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- table column
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC sp_addextendedproperty 'column property1   ', 'column property1 before', 'schema   ', 'babel_extended_properties_schema1   ', 'table   ', 'babel_extended_properties_table1   ', 'column   ', 'id   '
GO

EXEC sp_addextendedproperty 'column property2   ', 'column property2 before', 'schema   ', 'babel_extended_properties_schema1   ', 'table   ', 'babel_extended_properties_table1   ', 'column   ', 'name   '
GO

EXEC sp_addextendedproperty 'column property1   ', 'column property1 before', 'SCHEMA   ', 'BABEL_EXTENDED_PROPERTIES_SCHEMA1   ', 'TABLE   ', 'BABEL_EXTENDED_PROPERTIES_TABLE2   ', 'COLUMN   ', 'ID   '
GO

EXEC sp_addextendedproperty 'COLUMN PROPERTY2 "{\)  ', 'COLUMN PROPERTY2 BEFORE "{\)   ', 'SCHEMA   ', 'BABEL_EXTENDED_PROPERTIES_SCHEMA1   ', 'TABLE   ', 'BABEL_EXTENDED_PROPERTIES_TABLE2   ', 'COLUMN   ', 'LONG_LONG_LONG_long_long_long_long_long_long_long_long_long_long_long_long_long_name   '
GO

SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', NULL, 'Table   ', NULL, 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', NULL, 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table1   ', 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#id#!#column property1#!#column property1 before
COLUMN#!#name#!#column property2#!#column property2 before
~~END~~


SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table1   ', 'Column   ', 'Id   ')
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#id#!#column property1#!#column property1 before
~~END~~


SELECT * FROM fn_listextendedproperty('Column property1   ', 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table1   ', 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#id#!#column property1#!#column property1 before
~~END~~


SELECT * FROM fn_listextendedproperty('Column property1   ', 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table1   ', 'Column   ', 'Id   ')
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#id#!#column property1#!#column property1 before
~~END~~


SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table2   ', 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#Id#!#column property1#!#column property1 before
COLUMN#!#LONG_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name#!#COLUMN PROPERTY2 "{\)#!#COLUMN PROPERTY2 BEFORE "{\)   
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#COLUMN PROPERTY2 "{\)#!#COLUMN PROPERTY2 BEFORE "{\)   
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC sp_updateextendedproperty 'Column property1   ', 'column property1 after', 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table', 'Babel_extended_properties_table1   ', 'Column   ', 'Id   '
GO

EXEC sp_updateextendedproperty 'column property2 "{\)   ', 'Column property2 after   ', 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table', 'Babel_extended_properties_table2   ', 'Column   ', 'LONG_long_long_LONG_long_long_long_long_long_long_long_long_long_long_long_long_name   '
GO

SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table1   ', 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#id#!#column property1#!#column property1 after
COLUMN#!#name#!#column property2#!#column property2 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#COLUMN PROPERTY2 "{\)#!#Column property2 after   
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC sp_dropextendedproperty 'Column property2 "{\)     ', 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table2   ', 'Column   ', 'long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name   '
GO

SELECT * FROM fn_listextendedproperty(NULL, 'Schema   ', 'Babel_extended_properties_schema1   ', 'Table   ', 'Babel_extended_properties_table1   ', 'Column   ', NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
COLUMN#!#id#!#column property1#!#column property1 after
COLUMN#!#name#!#column property2#!#column property2 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- view
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


CREATE VIEW babel_extended_properties_schema1.babel_extended_properties_view1 AS
SELECT * FROM babel_extended_properties_schema1.babel_extended_properties_table1
GO

EXEC babel_sp_addextendedproperty 'view property1', 'view property1 before', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view1'
GO

EXEC babel_sp_addextendedproperty 'view property2', 'view property2 before', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view1'
GO

CREATE VIEW babel_extended_properties_schema1.babel_extended_properties_view2 AS
SELECT * FROM babel_extended_properties_schema1.BABEL_extended_properties_table2
GO

EXEC babel_sp_addextendedproperty 'view property1', 'view property1 before', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view2'
GO

EXEC babel_sp_addextendedproperty 'view property2', 'view property2 before', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, 'view', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'view', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
VIEW#!#babel_extended_properties_view1#!#view property1#!#view property1 before
VIEW#!#babel_extended_properties_view1#!#view property2#!#view property2 before
VIEW#!#babel_extended_properties_view2#!#view property1#!#view property1 before
VIEW#!#babel_extended_properties_view2#!#view property2#!#view property2 before
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
VIEW#!#babel_extended_properties_view1#!#view property1#!#view property1 before
VIEW#!#babel_extended_properties_view1#!#view property2#!#view property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'view property1', 'schema', 'babel_extended_properties_schema1', 'view', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
VIEW#!#babel_extended_properties_view1#!#view property1#!#view property1 before
VIEW#!#babel_extended_properties_view2#!#view property1#!#view property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'view property1', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
VIEW#!#babel_extended_properties_view1#!#view property1#!#view property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'view property1', 'view property1 after', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view1'
GO

EXEC babel_sp_updateextendedproperty 'view property2', 'view property2 after', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'view', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
VIEW#!#babel_extended_properties_view1#!#view property1#!#view property1 after
VIEW#!#babel_extended_properties_view1#!#view property2#!#view property2 before
VIEW#!#babel_extended_properties_view2#!#view property1#!#view property1 before
VIEW#!#babel_extended_properties_view2#!#view property2#!#view property2 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'view property2', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'view', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
VIEW#!#babel_extended_properties_view1#!#view property1#!#view property1 after
VIEW#!#babel_extended_properties_view1#!#view property2#!#view property2 before
VIEW#!#babel_extended_properties_view2#!#view property1#!#view property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- sequence
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


CREATE SEQUENCE babel_extended_properties_schema1.babel_extended_properties_seq1
GO

EXEC babel_sp_addextendedproperty 'sequence property1', 'sequence property1 before', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq1'
GO

EXEC babel_sp_addextendedproperty 'sequence property2', 'sequence property2 before', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq1'
GO

CREATE SEQUENCE babel_extended_properties_schema1.babel_extended_properties_seq2
GO

EXEC babel_sp_addextendedproperty 'sequence property1', 'sequence property1 before', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq2'
GO

EXEC babel_sp_addextendedproperty 'sequence property2', 'sequence property2 before', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, 'sequence', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'sequence', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property1#!#sequence property1 before
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property2#!#sequence property2 before
SEQUENCE#!#babel_extended_properties_seq2#!#sequence property1#!#sequence property1 before
SEQUENCE#!#babel_extended_properties_seq2#!#sequence property2#!#sequence property2 before
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property1#!#sequence property1 before
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property2#!#sequence property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'sequence property1', 'schema', 'babel_extended_properties_schema1', 'sequence', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property1#!#sequence property1 before
SEQUENCE#!#babel_extended_properties_seq2#!#sequence property1#!#sequence property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'sequence property1', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property1#!#sequence property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'sequence property1', 'sequence property1 after', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq1'
GO

EXEC babel_sp_updateextendedproperty 'sequence property2', 'sequence property2 after', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'sequence', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property1#!#sequence property1 after
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property2#!#sequence property2 before
SEQUENCE#!#babel_extended_properties_seq2#!#sequence property1#!#sequence property1 before
SEQUENCE#!#babel_extended_properties_seq2#!#sequence property2#!#sequence property2 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'sequence property2', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'sequence', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property1#!#sequence property1 after
SEQUENCE#!#babel_extended_properties_seq1#!#sequence property2#!#sequence property2 before
SEQUENCE#!#babel_extended_properties_seq2#!#sequence property1#!#sequence property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- procedure
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


CREATE PROCEDURE babel_extended_properties_schema1.babel_extended_properties_proc1
AS
BEGIN
    RETURN 1
END
GO

EXEC babel_sp_addextendedproperty 'procedure property1', 'procedure property1 before', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc1'
GO

EXEC babel_sp_addextendedproperty 'procedure property2', 'procedure property2 before', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc1'
GO

CREATE PROCEDURE babel_extended_properties_schema1.babel_extended_properties_proc2
AS
BEGIN
    RETURN 1
END
GO

EXEC babel_sp_addextendedproperty 'procedure property1', 'procedure property1 before', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc2'
GO

EXEC babel_sp_addextendedproperty 'procedure property2', 'procedure property2 before', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, 'procedure', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'procedure', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property1#!#procedure property1 before
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property2#!#procedure property2 before
PROCEDURE#!#babel_extended_properties_proc2#!#procedure property1#!#procedure property1 before
PROCEDURE#!#babel_extended_properties_proc2#!#procedure property2#!#procedure property2 before
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property1#!#procedure property1 before
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property2#!#procedure property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'procedure property1', 'schema', 'babel_extended_properties_schema1', 'procedure', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property1#!#procedure property1 before
PROCEDURE#!#babel_extended_properties_proc2#!#procedure property1#!#procedure property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'procedure property1', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property1#!#procedure property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'procedure property1', 'procedure property1 after', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc1'
GO

EXEC babel_sp_updateextendedproperty 'procedure property2', 'procedure property2 after', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'procedure', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property1#!#procedure property1 after
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property2#!#procedure property2 before
PROCEDURE#!#babel_extended_properties_proc2#!#procedure property1#!#procedure property1 before
PROCEDURE#!#babel_extended_properties_proc2#!#procedure property2#!#procedure property2 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'procedure property2', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'procedure', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property1#!#procedure property1 after
PROCEDURE#!#babel_extended_properties_proc1#!#procedure property2#!#procedure property2 before
PROCEDURE#!#babel_extended_properties_proc2#!#procedure property1#!#procedure property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- function
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


CREATE FUNCTION babel_extended_properties_schema1.babel_extended_properties_func1()
RETURNS INT AS
BEGIN
    RETURN 1
END
GO

EXEC babel_sp_addextendedproperty 'function property1', 'function property1 before', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func1'
GO

EXEC babel_sp_addextendedproperty 'function property2', 'function property2 before', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func1'
GO

CREATE FUNCTION babel_extended_properties_schema1.babel_extended_properties_func2()
RETURNS INT AS
BEGIN
    RETURN 1
END
GO

EXEC babel_sp_addextendedproperty 'function property1', 'function property1 before', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func2'
GO

EXEC babel_sp_addextendedproperty 'function property2', 'function property2 before', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, 'function', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'function', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
FUNCTION#!#babel_extended_properties_func1#!#function property1#!#function property1 before
FUNCTION#!#babel_extended_properties_func1#!#function property2#!#function property2 before
FUNCTION#!#babel_extended_properties_func2#!#function property1#!#function property1 before
FUNCTION#!#babel_extended_properties_func2#!#function property2#!#function property2 before
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
FUNCTION#!#babel_extended_properties_func1#!#function property1#!#function property1 before
FUNCTION#!#babel_extended_properties_func1#!#function property2#!#function property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'function property1', 'schema', 'babel_extended_properties_schema1', 'function', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
FUNCTION#!#babel_extended_properties_func1#!#function property1#!#function property1 before
FUNCTION#!#babel_extended_properties_func2#!#function property1#!#function property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'function property1', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
FUNCTION#!#babel_extended_properties_func1#!#function property1#!#function property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'function property1', 'function property1 after', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func1'
GO

EXEC babel_sp_updateextendedproperty 'function property2', 'function property2 after', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'function', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
FUNCTION#!#babel_extended_properties_func1#!#function property1#!#function property1 after
FUNCTION#!#babel_extended_properties_func1#!#function property2#!#function property2 before
FUNCTION#!#babel_extended_properties_func2#!#function property1#!#function property1 before
FUNCTION#!#babel_extended_properties_func2#!#function property2#!#function property2 after
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'function property2', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'function', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
FUNCTION#!#babel_extended_properties_func1#!#function property1#!#function property1 after
FUNCTION#!#babel_extended_properties_func1#!#function property2#!#function property2 before
FUNCTION#!#babel_extended_properties_func2#!#function property1#!#function property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- type
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
~~END~~


CREATE TYPE babel_extended_properties_schema1.babel_extended_properties_type1
AS TABLE(id int)
GO

EXEC babel_sp_addextendedproperty 'type property1', 'type property1 before', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type1'
GO

EXEC babel_sp_addextendedproperty 'type property2', 'type property2 before', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type1'
GO

CREATE TYPE babel_extended_properties_schema1.babel_extended_properties_type2
AS TABLE(id int)
GO

EXEC babel_sp_addextendedproperty 'type property1', 'type property1 before', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type2'
GO

EXEC babel_sp_addextendedproperty 'type property2', 12345678, 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', NULL, 'type', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'type', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TYPE#!#babel_extended_properties_type1#!#type property1#!#type property1 before
TYPE#!#babel_extended_properties_type1#!#type property2#!#type property2 before
TYPE#!#babel_extended_properties_type2#!#type property1#!#type property1 before
TYPE#!#babel_extended_properties_type2#!#type property2#!#12345678
~~END~~


EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TYPE#!#babel_extended_properties_type1#!#type property1#!#type property1 before
TYPE#!#babel_extended_properties_type1#!#type property2#!#type property2 before
~~END~~


EXEC babel_fn_listextendedproperty 'type property1', 'schema', 'babel_extended_properties_schema1', 'type', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TYPE#!#babel_extended_properties_type1#!#type property1#!#type property1 before
TYPE#!#babel_extended_properties_type2#!#type property1#!#type property1 before
~~END~~


EXEC babel_fn_listextendedproperty 'type property1', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type1', NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TYPE#!#babel_extended_properties_type1#!#type property1#!#type property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
6#!#TYPE#!#1#!#0#!#type property2#!#12345678
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_updateextendedproperty 'type property1', 'type property1 after', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type1'
GO

EXEC babel_sp_updateextendedproperty 'type property2', 87654321, 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'type', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TYPE#!#babel_extended_properties_type1#!#type property1#!#type property1 after
TYPE#!#babel_extended_properties_type1#!#type property2#!#type property2 before
TYPE#!#babel_extended_properties_type2#!#type property1#!#type property1 before
TYPE#!#babel_extended_properties_type2#!#type property2#!#87654321
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
6#!#TYPE#!#1#!#0#!#type property2#!#87654321
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


EXEC babel_sp_dropextendedproperty 'type property2', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type2'
GO

EXEC babel_fn_listextendedproperty NULL, 'schema', 'babel_extended_properties_schema1', 'type', NULL, NULL, NULL
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TYPE#!#babel_extended_properties_type1#!#type property1#!#type property1 after
TYPE#!#babel_extended_properties_type1#!#type property2#!#type property2 before
TYPE#!#babel_extended_properties_type2#!#type property1#!#type property1 before
~~END~~


SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- sp_rename
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~



-- sp_rename type is not supported, so we can only drop babel_extended_properties_type2
-- sp_rename 'babel_extended_properties_schema1.babel_extended_properties_type2', 'babel_extended_properties_type3', 'USERDATATYPE'
-- GO
SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


sp_rename 'babel_extended_properties_schema1.babel_extended_properties_func2', 'babel_extended_properties_func3', 'OBJECT'
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


sp_rename 'babel_extended_properties_schema1.babel_extended_properties_proc2', 'babel_extended_properties_proc3', 'OBJECT'
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


sp_rename 'babel_extended_properties_schema1.babel_extended_properties_seq2', 'babel_extended_properties_seq3', 'OBJECT'
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


sp_rename 'babel_extended_properties_schema1.babel_extended_properties_view2', 'babel_extended_properties_view3', 'OBJECT'
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


sp_rename 'babel_extended_properties_schema1.BABEL_extended_properties_table2.Id', 'id1', 'COLUMN'
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


sp_rename 'babel_extended_properties_schema1.BABEL_extended_properties_table2', 'babel_extended_properties_table3', 'OBJECT'
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- drop object
EXEC babel_extended_properties_proc
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 before
~~END~~


-- sp_rename type failed, so we can only drop babel_extended_properties_type2
DROP TYPE babel_extended_properties_schema1.babel_extended_properties_type2
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP FUNCTION babel_extended_properties_schema1.babel_extended_properties_func3
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP PROCEDURE babel_extended_properties_schema1.babel_extended_properties_proc3
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP SEQUENCE babel_extended_properties_schema1.babel_extended_properties_seq3
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP VIEW babel_extended_properties_schema1.babel_extended_properties_view3
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


ALTER TABLE babel_extended_properties_schema1.babel_extended_properties_table3 DROP id1
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP TABLE babel_extended_properties_schema1.babel_extended_properties_table3
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


DROP SCHEMA BABEL_extended_properties_schema2_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_long_name
GO

SELECT * FROM babel_extended_properties_view
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property1#!#view property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#view property2#!#view property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property1#!#sequence property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#sequence property2#!#sequence property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property1#!#procedure property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#procedure property2#!#procedure property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property1#!#function property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#function property2#!#function property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
6#!#TYPE#!#1#!#0#!#type property1#!#type property1 after
6#!#TYPE#!#1#!#0#!#type property2#!#type property2 before
~~END~~


EXEC babel_babelfish_extended_properties_proc
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- reset the login password
ALTER LOGIN normal_user WITH PASSWORD = '12345678';
GO

-- tsql user=normal_user password=12345678
USE babel_extended_properties_db
GO

-- normal_user should fail to execute sp_xxxxextendedproperty
sp_addextendedproperty 'database property3', 'database property3 before'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "object specified" because it does not exist or you do not have permissions.)~~


sp_updateextendedproperty 'schema property3', 'schema property3 before', 'schema', 'babel_extended_properties_schema1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1" because it does not exist or you do not have permissions.)~~


sp_dropextendedproperty 'table property3', 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_table1" because it does not exist or you do not have permissions.)~~


sp_addextendedproperty 'column property3', 'column property3 before', 'schema', 'babel_extended_properties_schema1', 'table', 'babel_extended_properties_table1', 'column', 'id'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_table1" because it does not exist or you do not have permissions.)~~


sp_updateextendedproperty 'view property3', 'view property3 before', 'schema', 'babel_extended_properties_schema1', 'view', 'babel_extended_properties_view1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_view1" because it does not exist or you do not have permissions.)~~


sp_dropextendedproperty 'sequence property3', 'schema', 'babel_extended_properties_schema1', 'sequence', 'babel_extended_properties_seq1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_seq1" because it does not exist or you do not have permissions.)~~


sp_addextendedproperty 'procedure property3', 'procedure property3 before', 'schema', 'babel_extended_properties_schema1', 'procedure', 'babel_extended_properties_proc1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_proc1" because it does not exist or you do not have permissions.)~~


sp_updateextendedproperty 'function property3', 'function property3 before', 'schema', 'babel_extended_properties_schema1', 'function', 'babel_extended_properties_func1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_func1" because it does not exist or you do not have permissions.)~~


sp_dropextendedproperty 'type property3', 'schema', 'babel_extended_properties_schema1', 'type', 'babel_extended_properties_type1'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Cannot find the object "babel_extended_properties_schema1.babel_extended_properties_type1" because it does not exist or you do not have permissions.)~~


-- tsql user=owner password=12345678
USE babel_extended_properties_db
GO

GRANT SELECT ON babel_extended_properties_schema1.babel_extended_properties_table1 TO normal_user
GO

-- tsql user=normal_user password=12345678
-- normal_user can get result from fn_listextendedproperty and sys.extended_properties after being granted
USE babel_extended_properties_db
GO

SELECT * FROM fn_listextendedproperty(NULL, 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
TABLE#!#babel_extended_properties_table1#!#table property1#!#table property1 after
TABLE#!#babel_extended_properties_table1#!#table property2#!#table property2 before
~~END~~


SELECT class, class_desc, IIF(major_id > 0, 1, 0) AS major_id, minor_id, name, value FROM sys.extended_properties
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property1#!#table property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#0#!#table property2#!#table property2 before
1#!#OBJECT_OR_COLUMN#!#1#!#1#!#column property1#!#column property1 after
1#!#OBJECT_OR_COLUMN#!#1#!#2#!#column property2#!#column property2 before
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
~~END~~


-- tsql user=owner password=12345678
USE babel_extended_properties_db
GO

REVOKE SELECT ON babel_extended_properties_schema1.babel_extended_properties_table1 FROM normal_user
GO

-- tsql user=normal_user password=12345678
-- normal_user can't get result from fn_listextendedproperty and sys.extended_properties after being revoked
SELECT * FROM fn_listextendedproperty(NULL, 'schema', 'babel_extended_properties_schema1', 'table', NULL, NULL, NULL)
GO
~~START~~
varchar#!#varchar#!#varchar#!#sql_variant
~~END~~


SELECT class, class_desc, IIF(major_id > 0, 1, 0) AS major_id, minor_id, name, value FROM sys.extended_properties
GO
~~START~~
tinyint#!#nvarchar#!#int#!#int#!#varchar#!#sql_variant
0#!#DATABASE#!#0#!#0#!#database property1#!#database property1 after
3#!#SCHEMA#!#1#!#0#!#schema property1#!#schema property1 after
3#!#SCHEMA#!#1#!#0#!#schema property2#!#schema property2 before
~~END~~


select * from sys.babelfish_extended_properties;
go
~~ERROR (Code: 33557097)~~

~~ERROR (Message: permission denied for table babelfish_extended_properties)~~


-- psql
do
$$ declare dbname text;
begin
    select setting from pg_settings where name like 'babelfishpg_tsql.database_name' into dbname;
    EXECUTE 'REVOKE CREATE ON DATABASE ' || quote_ident(dbname) || ' FROM babel_extended_properties_db_guest';
end $$;
GO
