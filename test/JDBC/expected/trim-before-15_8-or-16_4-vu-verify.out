-- customer case, mentioned in the jira description
DECLARE @custname NVARCHAR(50) = N'æ¯”å°”Â·æ‹‰èŽ«æ–¯'
SELECT @custname, 
    TRIM(@custname) as [TRIM]
    , LTRIM(@custname) as [LTRIM]
    , RTRIM(@custname) as [RTRIM]
    , LEFT(@custname, 4) as [LEFT4]
    , RIGHT(@custname, 4) as [RIGHT4]
    , SUBSTRING(@custname, 2, 4) as [SUBSTRING_2_4]
;
GO
~~START~~
nvarchar#!#nvarchar#!#nvarchar#!#nvarchar#!#nvarchar#!#nvarchar#!#nvarchar
æ¯”å°”Â·æ‹‰èŽ«æ–¯#!#æ¯”å°”Â·æ‹‰èŽ«æ–¯#!#æ¯”å°”Â·æ‹‰èŽ«æ–¯#!#æ¯”å°”Â·æ‹‰èŽ«æ–¯#!#æ¯”å°”Â·æ‹‰#!#Â·æ‹‰èŽ«æ–¯#!#å°”Â·æ‹‰èŽ«
~~END~~


-- NULL
SELECT TRIM(NULL)
GO
~~START~~
varchar
<NULL>
~~END~~


SELECT TRIM(NULL FROM NULL)
GO
~~START~~
varchar
<NULL>
~~END~~


SELECT TRIM('' FROM NULL)
GO
~~START~~
varchar
<NULL>
~~END~~


SELECT TRIM(NULL FROM '')
GO
~~START~~
varchar
<NULL>
~~END~~


-- input type char
DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
varchar
|abc?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM(@inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('ab? ' FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('abðŸ™‚ ' FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('abðŸ˜Ž ' FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet CHAR(10) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|Â·|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet CHAR(10) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|Â·|
~~END~~


-- input type varchar
DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
varchar
|abc?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM(@inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|æ¯”å°”Â·æ‹‰èŽ«æ–¯|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('ab? ' FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('abðŸ™‚ ' FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('abðŸ˜Ž ' FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) + '|'
GO
~~START~~
varchar
|?Â·??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) + '|'
GO
~~START~~
varchar
|?Â·??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(10) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|?Â·??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(10) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(MAX) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|?Â·??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(MAX) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) COLLATE CHINESE_PRC_CI_AS + '|'
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


-- with table column of type varchar with collation chinese_prc_ci_as
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_chinese_prc_ci_as
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


SELECT '|' + TRIM(b FROM a) COLLATE CHINESE_PRC_CI_AS + '|' FROM babel_4489_trim_chinese_prc_ci_as
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


-- with table column of type varchar with collation chinese_prc_cs_as
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_chinese_prc_cs_as
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


SELECT '|' + TRIM(b FROM a) COLLATE CHINESE_PRC_CS_AS + '|' FROM babel_4489_trim_chinese_prc_cs_as
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


-- with table column of type varchar with collation chinese_prc_ci_ai
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_chinese_prc_ci_ai
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


SELECT '|' + TRIM(b FROM a) COLLATE CHINESE_PRC_CI_AI + '|' FROM babel_4489_trim_chinese_prc_ci_ai
GO
~~START~~
varchar
|å°”Â·æ‹‰èŽ«|
~~END~~


-- with table column of type varchar with collation arabic_prc_ci_as
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_arabic_ci_as
GO
~~START~~
varchar
|Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚|
~~END~~


SELECT '|' + TRIM(b FROM a) COLLATE ARABIC_CI_AS + '|' FROM babel_4489_trim_arabic_ci_as
GO
~~START~~
varchar
|Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚|
~~END~~


-- with table column of type varchar with collation arabic_prc_cs_as
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_arabic_cs_as
GO
~~START~~
varchar
|Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚|
~~END~~


SELECT '|' + TRIM(b FROM a) COLLATE ARABIC_CS_AS + '|' FROM babel_4489_trim_arabic_cs_as
GO
~~START~~
varchar
|Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚|
~~END~~


-- with table column of type varchar with collation arabic_prc_ci_ai
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_arabic_ci_ai
GO
~~START~~
varchar
|Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚|
~~END~~


SELECT '|' + TRIM(b FROM a) COLLATE ARABIC_CI_AI + '|' FROM babel_4489_trim_arabic_ci_ai
GO
~~START~~
varchar
|Ø§Ù„Ù„Ù‡ Ù…Ø¹ Ø§Ù„Ù…ØªÙ‚|
~~END~~


-- input type nchar
DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
nvarchar
|abc?defghi??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
nvarchar
|??Â·???|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abðŸ˜ŽcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('abðŸ™‚ðŸ˜Ž ' FROM @inputString) + '|'
GO
~~START~~
nvarchar
|?c?defghi??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) + '|'
GO
~~START~~
nvarchar
|??Â·???|
~~END~~


DECLARE @inputString NCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|Â·|
~~END~~


-- with table column of type nchar
SELECT '|' + TRIM(b FROM a) + '|' FROM babel_4489_trim_t1 
GO
~~START~~
nvarchar
|cðŸ™‚defghi|
|å°”Â·æ‹‰èŽ«|
~~END~~


-- input type nvarchar
DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
nvarchar
|abcðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM(@inputString) + '|'
GO
~~START~~
nvarchar
|æ¯”å°”Â·æ‹‰èŽ«æ–¯|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abðŸ˜ŽcðŸ™‚defghiðŸ™‚ðŸ™‚    '
SELECT '|' + TRIM('abðŸ™‚ðŸ˜Ž ' FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghi|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    '
SELECT '|' + TRIM('æ¯”æ‹‰æ–¯ ' FROM @inputString) + '|'
GO
~~START~~
nvarchar
|å°”Â·æ‹‰èŽ«|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NVARCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|å°”Â·æ‹‰èŽ«|
~~END~~

DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NVARCHAR(MAX) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|å°”Â·æ‹‰èŽ«|
~~END~~


-- dependent objects
SELECT * FROM babel_4489_trim_dep_view
GO
~~START~~
varchar
|c?defghi|
~~END~~


EXEC babel_4489_trim_dep_proc
GO
~~START~~
nvarchar
|cðŸ™‚defghi|
~~END~~


SELECT * FROM babel_4489_trim_dep_func()
GO
~~START~~
nvarchar
|cðŸ™‚defghi|
~~END~~


SELECT * FROM babel_4489_trim_itvf_func()
GO
~~START~~
varchar
|c?defghi|
~~END~~


SELECT * FROM babel_4489_trim_dep_view_1
GO
~~START~~
varchar
|abc?defghi??|
|??Â·???|
~~END~~


SELECT * FROM babel_4489_trim_dep_view_2
GO
~~START~~
varchar
|abc?defghi??|
~~END~~


SELECT * FROM babel_4489_trim_dep_view_3
GO
~~START~~
varchar
|abcdefghi|
~~END~~


SELECT * FROM babel_4489_trim_dep_view_4
GO
~~START~~
varchar
|abcdefghi|
~~END~~


SELECT * FROM babel_4489_trim_dep_view_5
GO
~~START~~
varchar
|0x61626364|
~~END~~


SELECT * FROM babel_4489_trim_dep_view_6
GO
~~START~~
varchar
|cdefgh|
~~END~~


-- different datatypes of inputString and charSet
DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(20) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|Â·|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString CHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NVARCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet CHAR(20) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|??Â·???|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi|
~~END~~


DECLARE @inputString VARCHAR(50) = '  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|c?defghi??|
~~END~~


DECLARE @inputString VARCHAR(50) = '  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NVARCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
varchar
|?Â·??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi|
~~END~~


DECLARE @inputString NCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet CHAR(20) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|Â·|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(20) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|??Â·???|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NVARCHAR(20) = N'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|c?defghi??|
~~END~~


DECLARE @inputString NCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NVARCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|??Â·???|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet CHAR(20) = 'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet CHAR(20) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|æ¯”å°”Â·æ‹‰èŽ«æ–¯|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'ab? '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghi|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet VARCHAR(20) = 'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet VARCHAR(20) = 'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|å°”Â·æ‹‰èŽ«|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'abðŸ™‚ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  abcðŸ™‚defghiðŸ™‚ðŸ™‚    ', @charSet NCHAR(20) = N'abðŸ˜Ž '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|cðŸ™‚defghiðŸ™‚ðŸ™‚|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  æ¯”å°”Â·æ‹‰èŽ«æ–¯    ', @charSet NCHAR(20) = N'æ¯”æ‹‰æ–¯ '
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~START~~
nvarchar
|æ¯”å°”Â·æ‹‰èŽ«æ–¯|
~~END~~


DECLARE @inputString NVARCHAR(50) = N'  ABCDEF    ', @charSet BINARY(4) = 0x414243
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type "binary" is invalid for argument 1 of Trim function.)~~


DECLARE @inputString VARBINARY(50) = 0x41424344, @charSet VARBINARY(2) = 0x4144
SELECT '|' + TRIM(@charSet FROM @inputString) + '|'
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type varbinary is invalid for argument 1 of Trim function.)~~


-- input type UDT
-- -- in table babel_4489_trim_UDT, col 'a' has basetype image and col 'b' has basetype varchar
SELECT TRIM(a) FROM babel_4489_trim_UDT
GO
~~START~~
varchar
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type image is invalid for argument 1 of Trim function.)~~


SELECT TRIM(b) FROM babel_4489_trim_UDT
GO
~~START~~
varchar
abcdef
~~END~~


DECLARE @charSet VARCHAR(10) = 'ab'
SELECT TRIM(@charSet FROM a) FROM babel_4489_trim_UDT
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type image is invalid for argument 2 of Trim function.)~~


DECLARE @charSet VARCHAR(10) = 'ab'
SELECT TRIM(@charSet FROM b) FROM babel_4489_trim_UDT
GO
~~START~~
varchar
cdef
~~END~~


-- other different datatypes, all of these should be blocked
DECLARE @inputString date = '2016-12-21'
SELECT TRIM('12' FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type date is invalid for argument 2 of Trim function.)~~


DECLARE @inputString date = '2016-12-21', @charSet VARCHAR(10) = '12';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type date is invalid for argument 2 of Trim function.)~~


DECLARE @inputString date = '2016-12-21'
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type date is invalid for argument 1 of Trim function.)~~


DECLARE @date date = '12-21-16';  
DECLARE @inputString datetime = @date, @charSet VARCHAR(10) = '12';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type datetime is invalid for argument 2 of Trim function.)~~


DECLARE @date date = '12-21-16';  
DECLARE @inputString datetime = @date;
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type datetime is invalid for argument 1 of Trim function.)~~


DECLARE @inputString smalldatetime = '1955-12-13 12:43:10', @charSet VARCHAR(10) = '12';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type smalldatetime is invalid for argument 2 of Trim function.)~~


DECLARE @inputString smalldatetime = '1955-12-13 12:43:10';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type smalldatetime is invalid for argument 1 of Trim function.)~~


DECLARE @inputString time(4) = '12:10:05.1237', @charSet VARCHAR(10) = '10';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type time without time zone is invalid for argument 2 of Trim function.)~~


DECLARE @inputString time(4) = '12:10:05.1237';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type time without time zone is invalid for argument 1 of Trim function.)~~


DECLARE @inputString datetimeoffset(4) = '1968-10-23 12:45:37.1234 +10:0', @charSet VARCHAR(10) = '23';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type datetimeoffset is invalid for argument 2 of Trim function.)~~


DECLARE @inputString datetimeoffset(4) = '1968-10-23 12:45:37.1234 +10:0';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type datetimeoffset is invalid for argument 1 of Trim function.)~~


DECLARE @inputString datetime2(4) = '1968-10-23 12:45:37.1237', @charSet VARCHAR(10) = '23';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type datetime2 is invalid for argument 2 of Trim function.)~~


DECLARE @inputString datetime2(4) = '1968-10-23 12:45:37.1237';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type datetime2 is invalid for argument 1 of Trim function.)~~


DECLARE @inputString decimal = 123456, @charSet decimal = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type "decimal" is invalid for argument 1 of Trim function.)~~


DECLARE @inputString numeric = 12345.12, @charSet numeric = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type numeric is invalid for argument 1 of Trim function.)~~


DECLARE @inputString float = 12345.1, @charSet float = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type double precision is invalid for argument 1 of Trim function.)~~


DECLARE @inputString real = 12345.1, @charSet real = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type real is invalid for argument 1 of Trim function.)~~


DECLARE @inputString bigint = 12345678, @charSet bigint = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type bigint is invalid for argument 1 of Trim function.)~~


DECLARE @inputString int = 12345678, @charSet int = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type integer is invalid for argument 1 of Trim function.)~~


DECLARE @inputString smallint = 12356, @charSet smallint = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type smallint is invalid for argument 1 of Trim function.)~~


DECLARE @inputString tinyint = 235, @charSet tinyint = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type tinyint is invalid for argument 1 of Trim function.)~~


DECLARE @inputString money = 12356, @charSet money = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type money is invalid for argument 1 of Trim function.)~~


DECLARE @inputString smallmoney = 12356, @charSet smallmoney = 12;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type smallmoney is invalid for argument 1 of Trim function.)~~


DECLARE @inputString bit = 1, @charSet bit = 1;
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type "bit" is invalid for argument 1 of Trim function.)~~


DECLARE @inputString UNIQUEIDENTIFIER = CAST ('6F9619FF-8B86-D011-B42D-00C04FC964FF' AS UNIQUEIDENTIFIER)
DECLARE @charSet VARCHAR(10) = '6F';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type uniqueidentifier is invalid for argument 2 of Trim function.)~~

DECLARE @inputString UNIQUEIDENTIFIER = CAST ('6F9619FF-8B86-D011-B42D-00C04FC964FF' AS UNIQUEIDENTIFIER)
DECLARE @charSet VARCHAR(10) = '6F';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type uniqueidentifier is invalid for argument 1 of Trim function.)~~


SELECT TRIM(a FROM a) FROM babel_4489_trim_image;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type image is invalid for argument 1 of Trim function.)~~


DECLARE @charSet VARCHAR(10) = '6F';
SELECT TRIM(@charSet FROM a) from babel_4489_trim_image;
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type image is invalid for argument 2 of Trim function.)~~


SELECT TRIM(a FROM b) FROM babel_4489_trim_text
GO
~~START~~
nvarchar

~~END~~

SELECT TRIM(b FROM a) FROM babel_4489_trim_text
GO
~~START~~
nvarchar

~~END~~


DECLARE @charSet VARCHAR(20) = 'ab? '
SELECT TRIM(@charSet FROM a) FROM babel_4489_trim_text
GO
~~START~~
nvarchar
cðŸ™‚defghiðŸ™‚ðŸ™‚
~~END~~


DECLARE @charSet VARCHAR(20) = 'ab? '
SELECT TRIM(@charSet FROM b) FROM babel_4489_trim_text
GO
~~START~~
nvarchar
cðŸ™‚defghiðŸ™‚ðŸ™‚
~~END~~


DECLARE @inputString sql_variant = CAST ('6F9619FF-8B86-D011-B42D-00C04FC964FF' AS sql_variant)
DECLARE @charSet VARCHAR(10) = '6F';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type sql_variant is invalid for argument 2 of Trim function.)~~

DECLARE @inputString sql_variant = CAST ('6F9619FF-8B86-D011-B42D-00C04FC964FF' AS sql_variant)
DECLARE @charSet VARCHAR(10) = '6F';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type sql_variant is invalid for argument 1 of Trim function.)~~


DECLARE @inputString xml = CAST ('<body><fruit/></body>' AS xml)
DECLARE @charSet xml = CAST ('<fruit/>' AS xml);
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type xml is invalid for argument 1 of Trim function.)~~


DECLARE @inputString geometry = geometry::STGeomFromText('POINT (1 2)', 0), @charSet VARCHAR(10) = '(1 2)';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type geometry is invalid for argument 2 of Trim function.)~~

DECLARE @inputString geometry = geometry::STGeomFromText('POINT (1 2)', 0), @charSet VARCHAR(10) = '(1 2)';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type geometry is invalid for argument 1 of Trim function.)~~


DECLARE @inputString geography = geography::STGeomFromText('POINT(-122.34900 47.65100)', 4326), @charSet VARCHAR(10) = '2';
SELECT TRIM(@charSet FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type geography is invalid for argument 2 of Trim function.)~~

DECLARE @inputString geography = geography::STGeomFromText('POINT(-122.34900 47.65100)', 4326), @charSet VARCHAR(10) = '2';
SELECT TRIM(@inputString FROM @inputString)
GO
~~ERROR (Code: 33557097)~~

~~ERROR (Message: Argument data type geography is invalid for argument 1 of Trim function.)~~


DECLARE @inputString sql_variant = CAST ('6F9619FF-8B86-D011-B42D-00C04FC964FF' AS sql_variant)
DECLARE @charSet VARCHAR(10) = '6F';
SELECT TRIM(@charSet FROM CAST(@inputString AS VARCHAR(50)))
GO
~~START~~
varchar
9619FF-8B86-D011-B42D-00C04FC964
~~END~~


DECLARE @inputString xml = CAST ('<body><fruit/></body>' AS xml)
DECLARE @charSet xml = CAST ('<fruit/>' AS xml);
SELECT TRIM(CAST(@charSet AS VARCHAR) FROM CAST(@inputString AS VARCHAR(50)))
GO
~~START~~
varchar
body><fruit/></body
~~END~~


DECLARE @inputString geometry = geometry::STGeomFromText('POINT (1 2)', 0), @charSet VARCHAR(10) = '(1 2)';
SELECT TRIM(@charSet FROM CAST(@inputString AS VARCHAR(50)))
GO
~~START~~
varchar
POINT
~~END~~

