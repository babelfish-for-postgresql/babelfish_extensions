-- Nulls check
SELECT * FROM babel_index_nulls_order_before_15_5_a_v1
go
~~START~~
int
5
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_a_v2
go
~~START~~
int
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_a_v3
go
~~START~~
int
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_b_v1
go
~~START~~
varchar
pqr
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_b_v2
go
~~START~~
varchar
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_b_v3
go
~~START~~
varchar
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v1
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v2
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v3
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v4
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v5
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v6
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~


SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 OR a IS NULL ORDER BY a DESC
go
~~START~~
int
5
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 OR a IS NULL ORDER BY a ASC
go
~~START~~
int
<NULL>
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 OR a IS NULL ORDER BY a
go
~~START~~
int
<NULL>
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' OR b IS NULL ORDER BY b DESC
go
~~START~~
varchar
pqr
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' OR b IS NULL ORDER BY b ASC
go
~~START~~
varchar
<NULL>
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' OR b IS NULL ORDER BY b
go
~~START~~
varchar
<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') OR b IS NULL ORDER BY b DESC
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') OR b IS NULL ORDER BY b ASC
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') OR b IS NULL ORDER BY b
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') OR a IS NULL ORDER BY a DESC
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') OR a IS NULL ORDER BY a ASC
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') OR a IS NULL ORDER BY a
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~


-- Funcationality and query plans
SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 ORDER BY a DESC
go
~~START~~
int
5
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a ASC
go
~~START~~
int
6
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a
go
~~START~~
int
6
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' ORDER BY b DESC
go
~~START~~
varchar
pqr
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b ASC
go
~~START~~
varchar
stu
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b
go
~~START~~
varchar
stu
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b DESC
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b ASC
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a DESC
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a ASC
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~


-- Using indexes created on old versions, queries cannot be optimized
-- Should see sort step for all following queries
SELECT set_config('babelfishpg_tsql.enable_pg_hint', 'on', false)
go
~~START~~
text
on
~~END~~

SELECT set_config('babelfishpg_tsql.explain_costs', 'off', false)
go
~~START~~
text
off
~~END~~

SELECT set_config('enable_seqscan', 'off', false)
go
~~START~~
text
off
~~END~~

SELECT set_config('enable_bitmapscan', 'off', false)
go
~~START~~
text
off
~~END~~

SET babelfish_showplan_all ON
go

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 ORDER BY a DESC
go
~~START~~
text
Query Text: SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 ORDER BY a DESC
Limit
  ->  Sort
        Sort Key: a DESC NULLS LAST
        ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (a <= 5)
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a ASC
go
~~START~~
text
Query Text: SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a ASC
Limit
  ->  Sort
        Sort Key: a NULLS FIRST
        ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (a > 5)
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a
go
~~START~~
text
Query Text: SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a
Limit
  ->  Sort
        Sort Key: a NULLS FIRST
        ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (a > 5)
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' ORDER BY b DESC
go
~~START~~
text
Query Text: SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' ORDER BY b DESC
Limit
  ->  Sort
        Sort Key: b DESC NULLS LAST
        ->  Index Only Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (b <= 'sss'::"varchar")
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b ASC
go
~~START~~
text
Query Text: SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b ASC
Limit
  ->  Sort
        Sort Key: b NULLS FIRST
        ->  Index Only Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (b > 'sss'::"varchar")
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b
go
~~START~~
text
Query Text: SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b
Limit
  ->  Sort
        Sort Key: b NULLS FIRST
        ->  Index Only Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (b > 'sss'::"varchar")
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b DESC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b DESC
Limit
  ->  Sort
        Sort Key: b DESC NULLS LAST
        ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: ((a = 3) AND (b <= 'sss'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b ASC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b ASC
Limit
  ->  Sort
        Sort Key: b NULLS FIRST
        ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: ((a = 3) AND (b <= 'sss'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b
Limit
  ->  Sort
        Sort Key: b NULLS FIRST
        ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: ((a = 3) AND (b <= 'sss'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a DESC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a DESC
Limit
  ->  Sort
        Sort Key: a DESC NULLS LAST
        ->  Index Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (b = 'xyz'::"varchar")
              Filter: (a > 5)
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a ASC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a ASC
Limit
  ->  Sort
        Sort Key: a NULLS FIRST
        ->  Index Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (b = 'xyz'::"varchar")
              Filter: (a > 5)
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a
Limit
  ->  Sort
        Sort Key: a NULLS FIRST
        ->  Index Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
              Index Cond: (b = 'xyz'::"varchar")
              Filter: (a > 5)
~~END~~


-- Reset
SET babelfish_showplan_all OFF
go

-- Recreate indexes
DROP INDEX babel_index_nulls_order_before_15_5_asc_idx_a ON babel_index_nulls_order_before_15_5_tbl
go
DROP INDEX babel_index_nulls_order_before_15_5_desc_idx_b ON babel_index_nulls_order_before_15_5_tbl
go
DROP INDEX babel_index_nulls_order_before_15_5_default_idx_ab ON babel_index_nulls_order_before_15_5_tbl
go

CREATE INDEX babel_index_nulls_order_before_15_5_asc_idx_a ON babel_index_nulls_order_before_15_5_tbl (a ASC)
go
CREATE INDEX babel_index_nulls_order_before_15_5_desc_idx_b ON babel_index_nulls_order_before_15_5_tbl (b DESC)
go
CREATE INDEX babel_index_nulls_order_before_15_5_default_idx_ab ON babel_index_nulls_order_before_15_5_tbl (a, b)
go

-- Nulls check
SELECT * FROM babel_index_nulls_order_before_15_5_a_v1
go
~~START~~
int
5
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_a_v2
go
~~START~~
int
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_a_v3
go
~~START~~
int
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_b_v1
go
~~START~~
varchar
pqr
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_b_v2
go
~~START~~
varchar
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_b_v3
go
~~START~~
varchar
<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v1
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v2
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v3
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v4
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v5
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT * FROM babel_index_nulls_order_before_15_5_ab_v6
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~


SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 OR a IS NULL ORDER BY a DESC
go
~~START~~
int
5
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 OR a IS NULL ORDER BY a ASC
go
~~START~~
int
<NULL>
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 OR a IS NULL ORDER BY a
go
~~START~~
int
<NULL>
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' OR b IS NULL ORDER BY b DESC
go
~~START~~
varchar
pqr
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' OR b IS NULL ORDER BY b ASC
go
~~START~~
varchar
<NULL>
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' OR b IS NULL ORDER BY b
go
~~START~~
varchar
<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') OR b IS NULL ORDER BY b DESC
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') OR b IS NULL ORDER BY b ASC
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') OR b IS NULL ORDER BY b
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') OR a IS NULL ORDER BY a DESC
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') OR a IS NULL ORDER BY a ASC
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') OR a IS NULL ORDER BY a
go
~~START~~
int#!#varchar
<NULL>#!#<NULL>
~~END~~


-- Funcationality and query plans
SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 ORDER BY a DESC
go
~~START~~
int
5
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a ASC
go
~~START~~
int
6
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a
go
~~START~~
int
6
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' ORDER BY b DESC
go
~~START~~
varchar
pqr
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b ASC
go
~~START~~
varchar
stu
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b
go
~~START~~
varchar
stu
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b DESC
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b ASC
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b
go
~~START~~
int#!#varchar
3#!#ghi
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a DESC
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a ASC
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a
go
~~START~~
int#!#varchar
8#!#xyz
~~END~~


-- Check query plans, all aggregations should be optimized
-- into LIMIT + index scan
SET babelfish_showplan_all ON
go

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 ORDER BY a DESC
go
~~START~~
text
Query Text: SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a <= 5 ORDER BY a DESC
Limit
  ->  Index Only Scan Backward using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: (a <= 5)
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a ASC
go
~~START~~
text
Query Text: SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a ASC
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: (a > 5)
~~END~~

SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a
go
~~START~~
text
Query Text: SELECT TOP 1 a FROM babel_index_nulls_order_before_15_5_tbl WHERE a > 5 ORDER BY a
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: (a > 5)
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' ORDER BY b DESC
go
~~START~~
text
Query Text: SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b <= 'sss' ORDER BY b DESC
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: (b <= 'sss'::"varchar")
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b ASC
go
~~START~~
text
Query Text: SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b ASC
Limit
  ->  Index Only Scan Backward using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: (b > 'sss'::"varchar")
~~END~~

SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b
go
~~START~~
text
Query Text: SELECT TOP 1 b FROM babel_index_nulls_order_before_15_5_tbl WHERE b > 'sss' ORDER BY b
Limit
  ->  Index Only Scan Backward using babel_index_nulls_order_before_713975587e1cf6ee0c2fe82e930b89b5 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: (b > 'sss'::"varchar")
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b DESC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b DESC
Limit
  ->  Index Only Scan Backward using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: ((a = 3) AND (b <= 'sss'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b ASC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b ASC
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: ((a = 3) AND (b <= 'sss'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a = 3 AND b <= 'sss') ORDER BY b
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: ((a = 3) AND (b <= 'sss'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a DESC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a DESC
Limit
  ->  Index Only Scan Backward using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: ((a > 5) AND (b = 'xyz'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a ASC
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a ASC
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: ((a > 5) AND (b = 'xyz'::"varchar"))
~~END~~

SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a
go
~~START~~
text
Query Text: SELECT TOP 1 a, b FROM babel_index_nulls_order_before_15_5_tbl WHERE (a > 5 AND b = 'xyz') ORDER BY a
Limit
  ->  Index Only Scan using babel_index_nulls_order_before_a61e61121b6bd5392507d3ac38f74f27 on babel_index_nulls_order_before_15_5_tbl
        Index Cond: ((a > 5) AND (b = 'xyz'::"varchar"))
~~END~~


-- Reset
SET babelfish_showplan_all OFF
go
SELECT set_config('babelfishpg_tsql.enable_pg_hint', 'off', false)
go
~~START~~
text
off
~~END~~

SELECT set_config('babelfishpg_tsql.explain_costs', 'on', false)
go
~~START~~
text
on
~~END~~

SELECT set_config('enable_seqscan', 'on', false)
go
~~START~~
text
on
~~END~~

SELECT set_config('enable_bitmapscan', 'on', false)
go
~~START~~
text
on
~~END~~

