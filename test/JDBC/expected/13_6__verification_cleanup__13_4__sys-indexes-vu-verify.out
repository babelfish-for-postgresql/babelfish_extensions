SELECT COUNT(*) FROM sys.all_columns WHERE object_id = object_id('sys.indexes');
GO
~~START~~
int
19
~~END~~


-- should return 3, two rows for NONCLUSTERED indexes and one for HEAP on table
SELECT COUNT(*) FROM sys.indexes WHERE object_id = OBJECT_ID('t_sys_index_test1')
GO
~~START~~
int
2
~~END~~


SELECT COUNT(*) FROM sys.indexes WHERE name LIKE 'i_sys_index_test1%';
GO
~~START~~
int
2
~~END~~


SELECT type, type_desc FROM sys.indexes WHERE name LIKE 'i_sys_index_test1%';
GO
~~START~~
int#!#varchar
2#!#NONCLUSTERED
2#!#NONCLUSTERED
~~END~~


SELECT type, type_desc FROM sys.indexes WHERE object_id = OBJECT_ID('t_sys_index_test1');
GO
~~START~~
int#!#varchar
2#!#NONCLUSTERED
2#!#NONCLUSTERED
~~END~~


-- should return 1, one row for HEAP on table
SELECT COUNT(*) FROM sys.indexes WHERE object_id = OBJECT_ID('t_sys_no_index')
GO
~~START~~
int
0
~~END~~


SELECT type, type_desc FROM sys.indexes WHERE object_id = OBJECT_ID('t_sys_no_index');
GO
~~START~~
int#!#varchar
~~END~~


USE db1_sys_indexes
GO

-- index "t_sys_index_test1" should not be visible here
SELECT COUNT(*) FROM sys.indexes WHERE object_id = OBJECT_ID('t_sys_index_test1')
GO
~~START~~
int
0
~~END~~


SELECT COUNT(*) FROM sys.indexes WHERE name LIKE 'i_sys_index_test1%';
GO
~~START~~
int
0
~~END~~


USE master
GO

SELECT COUNT(*) FROM sys.indexes WHERE name LIKE 'i_sys_index_test%';
GO
~~START~~
int
2
~~END~~


-- should return two results, one for HEAP and one for NONCLUSTERED
-- is_unique_constraint should be 0 for both cases
SELECT type_desc, is_unique_constraint FROM sys.indexes WHERE object_id = OBJECT_ID('t_pkey_table')
GO
~~START~~
varchar#!#int
NONCLUSTERED#!#1
NONCLUSTERED#!#1
~~END~~


-- should return two results, one for HEAP and one for NONCLUSTERED
-- is_unique_constraint should be 1 for NONCLUSTERED case
SELECT type_desc, is_unique_constraint FROM sys.indexes WHERE object_id = OBJECT_ID('t_unique_index')
GO
~~START~~
varchar#!#int
NONCLUSTERED#!#1
~~END~~

