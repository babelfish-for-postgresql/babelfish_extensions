
------------------- CI_AI ----------------------
-- CASE 1: T_Const LIKE T_CollateExpr(T_Const)
select 1 where 'cantáis' like 'Cá%' collate Latin1_General_CI_AI;
GO
~~START~~
int
1
~~END~~


select 1 where 'shaEpéD' like '%Æ%e%' collate Latin1_General_CI_AI;
GO
~~START~~
int
1
~~END~~


select 1 where 'BleȘȘing' like '%nĜ' collate Latin1_General_CI_AI
GO
~~START~~
int
1
~~END~~


-- CASE 2: T_CollateExpr(T_Const) LIKE T_Const
select 1 where 'cOntáis' collate Latin1_General_CI_AI like 'CŐ%';
GO
~~START~~
int
1
~~END~~


select 1 where 'shaEpüD' collate Latin1_General_CI_AI like '%Æ%ú%';
GO
~~START~~
int
1
~~END~~


select 1 where 'BleȘȘing' collate Latin1_General_CI_AI like '%ŝ%nĜ';
GO
~~START~~
int
1
~~END~~


-- CASE 3: T_CollateExpr(T_Const) LIKE T_CollateExpr(T_Const)
select 1 where 'cOntáis' collate Latin1_General_CI_AI like 'CŐ%' collate Latin1_General_CI_AI;
GO
~~START~~
int
1
~~END~~


select 1 where 'shaEpüD' collate Latin1_General_CI_AI like '%Æ%ú%' collate Latin1_General_CI_AI;
GO
~~START~~
int
1
~~END~~


select 1 where 'BleȘȘing' collate Latin1_General_CI_AI like '%ŝ%nĜ' collate Latin1_General_CI_AI;
GO
~~START~~
int
1
~~END~~


-- CASE 4: T_ReLabelType (T_Var) LIKE T_Const
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'cafe';
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'jalapeno';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 're%';
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%n%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'TELEFONO';
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'resume';
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'movie';
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'naïve';
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'Piñata';
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%é%';
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ñ%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'ch%';
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%is';
GO
~~START~~
nvarchar
TEññiȘ
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%é%';
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ia%s';
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'orange';
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'jalapen%';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'e%ito';
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t1_ci with ñ 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ñ%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t1_ci with ü
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ú%';
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~


-- CASE 5: T_ReLabelType(T_Var) LIKE T_CollateExpr(T_Const)
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'cafe' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'jalapeno' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 're%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%n%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'TELEFONO' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'resume' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'movie' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'naïve' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'Piñata' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%é%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ñ%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'ch%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%is' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
TEññiȘ
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%é%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ia%s' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'orange' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'jalapen%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE 'e%ito' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t1_ci with ñ 
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ñ%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t1_ci with ü
SELECT * FROM babel_4791_vu_prepare_t1_ci WHERE col LIKE '%ú%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 6: T_ReLabelType(T_Var) LIKE T_ReLabelType(T_Var)
SELECT * FROM babel_4791_vu_prepare_t6_ci WHERE a LIKE b
GO
~~START~~
nvarchar#!#nvarchar
Ŭwmed#!#uŴɱêÐ
Æmed#!#aeMéD
Șpain#!#SPÅǏn
~~END~~


-- CASE 7: T_CollateExpr(T_ReLabel(T_Var)) LIKE T_Const
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'cafe';
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'jalapeno';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 're%';
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%n%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'TELEFONO';
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'resume';
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'movie';
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'naïve';
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'Piñata';
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'ch%';
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%is';
GO
~~START~~
nvarchar
TEññiȘ
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%é%';
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ia%s';
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'orange';
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'jalapen%';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'e%ito';
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t7_ci with ñ 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ñ%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t7_ci with ü
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ú%';
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 8: T_CollateExpr(T_ReLabel(T_Var)) LIKE T_CollateExpr(T_Const)
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'cafe' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'jalapeno' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 're%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%n%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'TELEFONO' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'resume' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'movie' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'naïve' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'Piñata' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%é%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ñ%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'ch%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%is' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
TEññiȘ
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%é%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ia%s' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'orange' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'jalapen%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE 'e%ito' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t7_ci with ñ 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ñ%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t7_ci with ü
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE '%ú%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 9: T_FuncExpr LIKE T_CollateExpr(T_Const)
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE 'cafe' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE 'jalapeno' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE SUBSTRING(col, 1, 3) COLLATE Latin1_General_CI_AI LIKE 're%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(col) COLLATE Latin1_General_CI_AI LIKE '%n%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(col) COLLATE Latin1_General_CI_AI LIKE 'TELEFONO' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE 'resume' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(LOWER(col)) COLLATE Latin1_General_CI_AI LIKE 'movie' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(LOWER(col)) COLLATE Latin1_General_CI_AI LIKE 'naïve' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(UPPER(col)) COLLATE Latin1_General_CI_AI LIKE 'Piñata' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE SUBSTRING(UPPER(LOWER(col)), 1, 3) COLLATE Latin1_General_CI_AI LIKE '%é%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
TELÉFONO
película
TEññiȘ
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE '%ñ%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~



-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE SUBSTRING(col, 1, 3) COLLATE Latin1_General_CI_AI LIKE 'ch%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE '%is' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
TEññiȘ
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE '%é%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
TELÉFONO
película
canapé
chaptéR
TEññiȘ
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE '%ia%s' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE UPPER(col) COLLATE Latin1_General_CI_AI LIKE 'orange' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(col) COLLATE Latin1_General_CI_AI LIKE 'jalapen%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(col) COLLATE Latin1_General_CI_AI LIKE 'e%ito' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t7_ci with ñ 
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(col) COLLATE Latin1_General_CI_AI LIKE '%ñ%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t7_ci with ü
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE LOWER(col) COLLATE Latin1_General_CI_AI LIKE '%ú%' COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 10: T_ReLabelType(T_Param) LIKE T_ReLabelType(T_Param)
declare @a varchar='RaŊdom';
declare @b varchar='Ra%';
SELECT 1 WHERE @a LIKE @b COLLATE Latin1_General_CI_AI;
GO
~~START~~
int
1
~~END~~


-- CASE 11: T_ReLabelType(T_Var) LIKE T_ReLabelType(T_Param)
declare @c varchar='e%ito';
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col COLLATE Latin1_General_CI_AI LIKE @c;
GO
~~START~~
nvarchar
~~END~~


declare @d varchar='%ú%';
SELECT * FROM babel_4791_vu_prepare_t7_ci WHERE col LIKE @d COLLATE Latin1_General_CI_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Piñata
Año Nuevo
TELÉFONO
película
árbol
canapé
chaptéR
TEññiȘ
~~END~~


-- CASE 12: LIKE inside CASE
SELECT CASE WHEN col COLLATE Latin1_General_CI_AI LIKE 'jalapen%' THEN 1 ELSE 2 END FROM babel_4791_vu_prepare_t7_ci;
GO
~~START~~
int
2
1
2
2
2
2
2
2
2
2
2
2
~~END~~


SELECT CASE WHEN col LIKE '%is' COLLATE Latin1_General_CI_AI THEN 1 ELSE 2 END FROM babel_4791_vu_prepare_t7_ci;
GO
~~START~~
int
2
2
2
2
2
2
2
2
2
2
2
1
~~END~~



-- CASE 13: SUBQUERY
-- SIMPLE SUBQUERY (LIKE OPERATOR AS SUBQUERY)
-- returns 1 row
SELECT col1 FROM babel_4791_vu_prepare_t13_1_ci WHERE col2 IN (SELECT col FROM babel_4791_vu_prepare_t13_2_ci WHERE col LIKE 'Àb%');
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- returns 2 rows
SELECT col1 FROM babel_4791_vu_prepare_t13_1_ci WHERE col2 IN (SELECT col FROM babel_4791_vu_prepare_t13_2_ci WHERE col LIKE '%aŖ%l%');
GO
~~START~~
nvarchar
Piñata
Año Nuevo
~~END~~


-- returns 1 rows
SELECT col1 FROM babel_4791_vu_prepare_t13_1_ci WHERE col2 IN (SELECT col FROM babel_4791_vu_prepare_t13_2_ci WHERE col LIKE '%ţÕ');
GO
~~START~~
nvarchar
canapé
~~END~~


-- COMPLEX SUBQUERY (LIKE OOPERATOR CONRTAINING SUBQUERY)
-- returns 1 row
SELECT * FROM babel_4791_vu_prepare_t13_1_ci WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'shaEpéD' LIKE 'Ș%' COLLATE Latin1_General_CI_AI) = 1 THEN 'TEñ%' ELSE 'ár%' END);
GO
~~START~~
nvarchar#!#nvarchar
TEññiȘ#!#patín
~~END~~


SELECT * FROM babel_4791_vu_prepare_t13_1_ci WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'naïve' LIKE 'Ș%' COLLATE Latin1_General_CI_AI) = 1 THEN 'TEñ%' ELSE 'ár%' END);
GO
~~START~~
nvarchar#!#nvarchar
árbol#!#difícil
~~END~~


-- returns 4 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_ci WHERE col1 LIKE (CASE WHEN 1 = 1 THEN '%I%' ELSE '%t%' END);
GO
~~START~~
nvarchar#!#nvarchar
naïve#!#cuídate
Piñata#!#gárgola
película#!#réquiem
TEññiȘ#!#patín
~~END~~


-- rerurns 4 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_ci WHERE col1 LIKE (CASE WHEN 2 = 1 THEN '%I%' ELSE '%t%' END);
GO
~~START~~
nvarchar#!#nvarchar
Piñata#!#gárgola
TELÉFONO#!#núcleo
chaptéR#!#enérgetico
TEññiȘ#!#patín
~~END~~


-- returns 2 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_ci WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'shaEpéD' LIKE 'Ș%' COLLATE Latin1_General_CI_AI) = 1 THEN '%a' ELSE '%é' END);
GO
~~START~~
nvarchar#!#nvarchar
Piñata#!#gárgola
película#!#réquiem
~~END~~


-- returns 4 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_ci WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'naïve' LIKE 'Ș%' COLLATE Latin1_General_CI_AI) = 1 THEN '%a' ELSE '%é' END);
GO
~~START~~
nvarchar#!#nvarchar
café#!#prójimo
résumé#!#críquet
naïve#!#cuídate
canapé#!#crédito
~~END~~



------------------- CS_AI ----------------------
-- CASE 1: T_Const LIKE T_CollateExpr(T_Const)
select 1 where 'cantáis' like 'cá%' collate Latin1_General_CS_AI;
GO
~~START~~
int
1
~~END~~


select 1 where 'shaEpéD' like '%ǣ%e%' collate Latin1_General_CS_AI;
GO
~~START~~
int
~~END~~


select 1 where 'BleȘȘing' like '%nĝ' collate Latin1_General_CS_AI
GO
~~START~~
int
1
~~END~~


-- CASE 2: T_CollateExpr(T_Const) LIKE T_Const
select 1 where 'cOntáis' collate Latin1_General_CS_AI like 'cŐ%';
GO
~~START~~
int
1
~~END~~


select 1 where 'shaEpüD' collate Latin1_General_CS_AI like '%ǣ%ú%';
GO
~~START~~
int
~~END~~


select 1 where 'BlesȘing' collate Latin1_General_CS_AI like '%ŝ%nĝ';
GO
~~START~~
int
1
~~END~~


-- CASE 3: T_CollateExpr(T_Const) LIKE T_CollateExpr(T_Const)
select 1 where 'cOntáis' collate Latin1_General_CS_AI like 'cŐ%' collate Latin1_General_CS_AI;
GO
~~START~~
int
1
~~END~~


select 1 where 'shaEpüD' collate Latin1_General_CS_AI like '%ǣ%ú%' collate Latin1_General_CS_AI;
GO
~~START~~
int
~~END~~


select 1 where 'BleȘsing' collate Latin1_General_CS_AI like '%ŝ%ng' collate Latin1_General_CS_AI;
GO
~~START~~
int
1
~~END~~


-- CASE 4: T_ReLabelType (T_Var) LIKE T_Const
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'cafe';
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'jalapeno';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 're%';
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%n%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'TELEFONO';
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'resume';
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'movie';
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'naïve';
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'Piñata';
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%é%';
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ñ%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'ch%';
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%is';
GO
~~START~~
nvarchar
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%é%';
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ia%s';
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'orange';
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'jalapen%';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'e%ito';
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t1_cs with ñ 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ñ%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t1_cs with ü
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ú%';
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~


-- CASE 5: T_ReLabelType(T_Var) LIKE T_CollateExpr(T_Const)
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'cafe' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'jalapeno' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 're%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%n%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'TELEFONO' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'resume' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'movie' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'naïve' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'Piñata' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%é%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~

SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ñ%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'ch%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%is' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%é%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ia%s' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'orange' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'jalapen%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE 'e%ito' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t1_cs with ñ 
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ñ%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t1_cs with ü
SELECT * FROM babel_4791_vu_prepare_t1_cs WHERE col LIKE '%ú%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 6: T_ReLabelType(T_Var) LIKE T_ReLabelType(T_Var)
SELECT * FROM babel_4791_vu_prepare_t6_cs WHERE a LIKE b
GO
~~START~~
nvarchar#!#nvarchar
~~END~~


-- CASE 7: T_CollateExpr(T_ReLabel(T_Var)) LIKE T_Const
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'cafe';
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'jalapeno';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 're%';
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%n%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'TELEFONO';
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'resume';
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'movie';
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'naïve';
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'Piñata';
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'ch%';
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%is';
GO
~~START~~
nvarchar
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%é%';
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ia%s';
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'orange';
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'jalapen%';
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'e%ito';
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t7_cs with ñ 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ñ%';
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t7_cs with ü
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ú%';
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 8: T_CollateExpr(T_ReLabel(T_Var)) LIKE T_CollateExpr(T_Const)
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'cafe' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'jalapeno' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 're%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%n%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'TELEFONO' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
TELÉFONO
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'resume' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'movie' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'naïve' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
naïve
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'Piñata' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
Piñata
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%é%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ñ%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'ch%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%is' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%é%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Año Nuevo
película
canapé
chaptéR
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ia%s' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'orange' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'jalapen%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE 'e%ito' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t7_cs with ñ 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ñ%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t7_cs with ü
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE '%ú%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 9: T_FuncExpr LIKE T_CollateExpr(T_Const)
-- Simple matches
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE 'cafe' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE 'jalapeno' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Wildcards
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE SUBSTRING(col, 1, 3) COLLATE Latin1_General_CS_AI LIKE 're%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(col) COLLATE Latin1_General_CS_AI LIKE '%n%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- Case insensitive
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(col) COLLATE Latin1_General_CS_AI LIKE 'TELEFONO' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Accents variations 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE 'resume' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(LOWER(col)) COLLATE Latin1_General_CS_AI LIKE 'movie' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple accented characters
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(LOWER(col)) COLLATE Latin1_General_CS_AI LIKE 'naïve' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(UPPER(col)) COLLATE Latin1_General_CS_AI LIKE 'Piñata' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Different positions
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE SUBSTRING(UPPER(LOWER(col)), 1, 3) COLLATE Latin1_General_CS_AI LIKE '%é%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~

SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE '%ñ%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~



-- Wildcard start
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE SUBSTRING(col, 1, 3) COLLATE Latin1_General_CS_AI LIKE 'ch%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
chaptéR
~~END~~


-- Wildcard end 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE '%is' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Wildcard middle
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE '%é%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Multiple wildcards 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE '%ia%s' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- No match
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE UPPER(col) COLLATE Latin1_General_CS_AI LIKE 'orange' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- Diacritic variations
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(col) COLLATE Latin1_General_CS_AI LIKE 'jalapen%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- Different accented vowels
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(col) COLLATE Latin1_General_CS_AI LIKE 'e%ito' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
~~END~~


-- babel_4791_vu_prepare_t7_cs with ñ 
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(col) COLLATE Latin1_General_CS_AI LIKE '%ñ%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
jalapeño
naïve
Piñata
Año Nuevo
TELÉFONO
canapé
TEññiȘ
~~END~~


-- babel_4791_vu_prepare_t7_cs with ü
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE LOWER(col) COLLATE Latin1_General_CS_AI LIKE '%ú%' COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
résumé
Año Nuevo
película
~~END~~



-- CASE 10: T_ReLabelType(T_Param) LIKE T_ReLabelType(T_Param)
declare @a varchar='RaŊdom';
declare @b varchar='ra%';
SELECT 1 WHERE @a LIKE @b COLLATE Latin1_General_CS_AI;
GO
~~START~~
int
~~END~~


-- CASE 11: T_ReLabelType(T_Var) LIKE T_ReLabelType(T_Param)
declare @c varchar='e%ito';
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col COLLATE Latin1_General_CS_AI LIKE @c;
GO
~~START~~
nvarchar
~~END~~


declare @d varchar='%ú%';
SELECT * FROM babel_4791_vu_prepare_t7_cs WHERE col LIKE @d COLLATE Latin1_General_CS_AI;
GO
~~START~~
nvarchar
café
jalapeño
résumé
naïve
Piñata
Año Nuevo
TELÉFONO
película
árbol
canapé
chaptéR
TEññiȘ
~~END~~


-- CASE 12: LIKE inside CASE
SELECT CASE WHEN col COLLATE Latin1_General_CS_AI LIKE 'jalapen%' THEN 1 ELSE 2 END FROM babel_4791_vu_prepare_t7_cs;
GO
~~START~~
int
2
1
2
2
2
2
2
2
2
2
2
2
~~END~~


SELECT CASE WHEN col LIKE '%is' COLLATE Latin1_General_CS_AI THEN 1 ELSE 2 END FROM babel_4791_vu_prepare_t7_cs;
GO
~~START~~
int
2
2
2
2
2
2
2
2
2
2
2
2
~~END~~



-- CASE 13: SUBQUERY
-- SIMPLE SUBQUERY (LIKE OPERATOR AS SUBQUERY)
-- returns 1 row
SELECT col1 FROM babel_4791_vu_prepare_t13_1_cs WHERE col2 IN (SELECT col FROM babel_4791_vu_prepare_t13_2_cs WHERE col LIKE 'áb%');
GO
~~START~~
nvarchar
jalapeño
~~END~~


-- returns 2 rows
SELECT col1 FROM babel_4791_vu_prepare_t13_1_cs WHERE col2 IN (SELECT col FROM babel_4791_vu_prepare_t13_2_cs WHERE col LIKE '%ar%l%');
GO
~~START~~
nvarchar
Piñata
Año Nuevo
~~END~~


-- returns 1 rows
SELECT col1 FROM babel_4791_vu_prepare_t13_1_cs WHERE col2 IN (SELECT col FROM babel_4791_vu_prepare_t13_2_cs WHERE col LIKE '%ţö');
GO
~~START~~
nvarchar
canapé
~~END~~


-- COMPLEX SUBQUERY (LIKE OOPERATOR CONRTAINING SUBQUERY)
-- returns 1 row
SELECT * FROM babel_4791_vu_prepare_t13_1_cs WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'ShaEpéD' LIKE 'Ș%' COLLATE Latin1_General_CS_AI) = 1 THEN 'TEñ%' ELSE 'ár%' END);
GO
~~START~~
nvarchar#!#nvarchar
TEññiȘ#!#patín
~~END~~


SELECT * FROM babel_4791_vu_prepare_t13_1_cs WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'naïve' LIKE 'Ș%' COLLATE Latin1_General_CS_AI) = 1 THEN 'TEñ%' ELSE 'ár%' END);
GO
~~START~~
nvarchar#!#nvarchar
árbol#!#difícil
~~END~~


-- returns 4 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_cs WHERE col1 LIKE (CASE WHEN 1 = 1 THEN '%i%' ELSE '%t%' END);
GO
~~START~~
nvarchar#!#nvarchar
naïve#!#cuídate
Piñata#!#gárgola
película#!#réquiem
TEññiȘ#!#patín
~~END~~


-- rerurns 2 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_cs WHERE col1 LIKE (CASE WHEN 2 = 1 THEN '%i%' ELSE '%t%' END);
GO
~~START~~
nvarchar#!#nvarchar
Piñata#!#gárgola
chaptéR#!#enérgetico
~~END~~


-- returns 2 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_cs WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'ShaEpéD' LIKE 'Ș%' COLLATE Latin1_General_CS_AI) = 1 THEN '%a' ELSE '%é' END);
GO
~~START~~
nvarchar#!#nvarchar
Piñata#!#gárgola
película#!#réquiem
~~END~~


-- returns 4 rows
SELECT * FROM babel_4791_vu_prepare_t13_1_cs WHERE col1 LIKE (CASE WHEN (SELECT 1 WHERE 'naïve' LIKE 'Ș%' COLLATE Latin1_General_CS_AI) = 1 THEN '%a' ELSE '%é' END);
GO
~~START~~
nvarchar#!#nvarchar
café#!#prójimo
résumé#!#críquet
naïve#!#cuídate
canapé#!#crédito
~~END~~

